import{A as _}from"./Api.908013cd.js";import{e as A}from"./mitt.7f99bbc0.js";import{d as V,r as M,O as S,K as z,S as r,e as L,f as B,z as e,m as o,g as N,u as n,x as w}from"./vue.72f2672d.js";import"./http-client.193f2c5b.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";const R={class:"dialog-footer"},T=w("取 消"),q=w("确 定"),E=V({name:"admin/api/form"}),Q=V({...E,props:{title:{type:String,default:""},apiTreeData:{type:Array,default:()=>[]}},setup(c,{expose:x}){const g=M(),t=S({showDialog:!1,sureLoading:!1,form:{enabled:!0}}),{form:a}=z(t),h=async(m={})=>{if(m.id>0){const l=await new _().get({id:m.id},{loading:!0});if(l!=null&&l.success){let s=l.data;s.parentId=s.parentId&&s.parentId>0?s.parentId:void 0,t.form=s}}else t.form={enabled:!0};t.showDialog=!0},y=()=>{t.showDialog=!1},I=()=>{g.value.validate(async m=>{if(!m)return;t.sureLoading=!0;let l={};t.form.parentId=t.form.parentId&&t.form.parentId>0?t.form.parentId:void 0,t.form.id!=null&&t.form.id>0?l=await new _().update(t.form,{showSuccessMessage:!0}):l=await new _().add(t.form,{showSuccessMessage:!0}),t.sureLoading=!1,l!=null&&l.success&&(A.emit("refreshApi"),t.showDialog=!1)})};return x({open:h}),(m,l)=>{const s=r("el-tree-select"),i=r("el-form-item"),u=r("el-col"),f=r("el-input"),p=r("el-radio-button"),D=r("el-radio-group"),v=r("el-switch"),k=r("el-row"),U=r("el-form"),b=r("el-button"),C=r("el-dialog");return L(),B("div",null,[e(C,{modelValue:t.showDialog,"onUpdate:modelValue":l[6]||(l[6]=d=>t.showDialog=d),"destroy-on-close":"",title:c.title,draggable:"",width:"600px"},{footer:o(()=>[N("span",R,[e(b,{onClick:y,size:"default"},{default:o(()=>[T]),_:1}),e(b,{type:"primary",onClick:I,size:"default",loading:t.sureLoading},{default:o(()=>[q]),_:1},8,["loading"])])]),default:o(()=>[e(U,{model:n(a),ref_key:"formRef",ref:g,size:"default","label-width":"80px"},{default:o(()=>[e(k,{gutter:35},{default:o(()=>[e(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(i,{label:"上级接口"},{default:o(()=>[e(s,{modelValue:n(a).parentId,"onUpdate:modelValue":l[0]||(l[0]=d=>n(a).parentId=d),data:c.apiTreeData,"node-key":"id","check-strictly":"","default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",class:"w100"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(i,{label:"接口名称",prop:"label",rules:[{required:!0,message:"请输入接口名称",trigger:["blur","change"]}]},{default:o(()=>[e(f,{modelValue:n(a).label,"onUpdate:modelValue":l[1]||(l[1]=d=>n(a).label=d),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(i,{label:"接口地址",prop:"path",rules:[{required:!0,message:"请输入接口地址",trigger:["blur","change"]}]},{default:o(()=>[e(f,{modelValue:n(a).path,"onUpdate:modelValue":l[2]||(l[2]=d=>n(a).path=d),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(i,{label:"接口方法",prop:"httpMethods"},{default:o(()=>[e(D,{modelValue:n(a).httpMethods,"onUpdate:modelValue":l[3]||(l[3]=d=>n(a).httpMethods=d)},{default:o(()=>[e(p,{label:"get"}),e(p,{label:"put"}),e(p,{label:"post"}),e(p,{label:"patch"}),e(p,{label:"delete"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(i,{label:"接口描述",prop:"description"},{default:o(()=>[e(f,{modelValue:n(a).description,"onUpdate:modelValue":l[4]||(l[4]=d=>n(a).description=d),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:o(()=>[e(i,{label:"启用"},{default:o(()=>[e(v,{modelValue:n(a).enabled,"onUpdate:modelValue":l[5]||(l[5]=d=>n(a).enabled=d)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{Q as default};
