import{_ as P}from"./preload-helper.101896b7.js";import{P as V}from"./Permission.54b076e4.js";import{V as z}from"./View.329703ed.js";import{l as N}from"./tree.d5b28a07.js";import{e as O}from"./mitt.7f99bbc0.js";import{d as y,a6 as R,r as B,O as E,K as F,S as u,e as q,f as W,z as e,m as a,g as _,u as o,y as w,x as v,L as $}from"./vue.df334614.js";import{_ as j}from"./_plugin-vue_export-helper.c27b6911.js";import"./http-client.28a8ff7a.js";import"./index.de963593.js";import"./index.390778f0.js";import"./index.4621962e.js";import"./storage.6b2e7cd0.js";const G={class:"my-flex my-flex-between"},H=["title"],J={class:"dialog-footer"},Q=v("取 消"),X=v("确 定"),Y=y({name:"admin/permission/permission-menu-form"}),Z=y({...Y,props:{title:{type:String,default:""},permissionTreeData:{type:Array,default:()=>[]}},setup(g,{expose:I}){const U=R(()=>P(()=>import("./index.56bdeb3a.js"),["assets/index.56bdeb3a.js","assets/getStyleSheets.de5032d4.js","assets/index.4621962e.js","assets/vue.df334614.js","assets/_plugin-vue_export-helper.c27b6911.js","assets/index.0e23bf1c.css"])),{proxy:x}=$(),b=B(),n=E({showDialog:!1,sureLoading:!1,form:{enabled:!0,isKeepAlive:!0},viewTreeData:[]}),{form:d}=F(n),D=async()=>{const s=await new z().getList();s!=null&&s.success&&s.data&&s.data.length>0?n.viewTreeData=N(s.data):n.viewTreeData=[]},C=async(s={})=>{if(x.$modal.loading(),await D(),s.id>0){const l=await new V().getMenu({id:s.id});if(l!=null&&l.success){let i=l.data;i.parentId=i.parentId&&i.parentId>0?i.parentId:void 0,n.form=i}}else n.form={enabled:!0,isKeepAlive:!0,icon:"ele-Memo"};x.$modal.closeLoading(),n.showDialog=!0},A=(s,l)=>{var i,m;return s?((i=l.label)==null?void 0:i.indexOf(s))!==-1||((m=l.path)==null?void 0:m.indexOf(s))!==-1:!0},h=s=>{s&&(n.form.label||(n.form.label=s.label),n.form.path||(n.form.path="/"+s.path))},k=()=>{n.showDialog=!1},T=()=>{b.value.validate(async s=>{if(!s)return;n.sureLoading=!0;let l={};n.form.parentId=n.form.parentId&&n.form.parentId>0?n.form.parentId:void 0,n.form.id!=null&&n.form.id>0?l=await new V().updateMenu(n.form,{showSuccessMessage:!0}):l=await new V().addMenu(n.form,{showSuccessMessage:!0}),n.sureLoading=!1,l!=null&&l.success&&(O.emit("refreshPermission"),n.showDialog=!1)})};return I({open:C}),(s,l)=>{const i=u("el-tree-select"),m=u("el-form-item"),r=u("el-col"),p=u("el-input"),M=u("el-input-number"),f=u("el-switch"),L=u("el-row"),S=u("el-form"),c=u("el-button"),K=u("el-dialog");return q(),W("div",null,[e(K,{modelValue:n.showDialog,"onUpdate:modelValue":l[15]||(l[15]=t=>n.showDialog=t),"destroy-on-close":"",title:g.title,draggable:"",width:"600px"},{footer:a(()=>[_("span",J,[e(c,{onClick:k,size:"default"},{default:a(()=>[Q]),_:1}),e(c,{type:"primary",onClick:T,size:"default",loading:n.sureLoading},{default:a(()=>[X]),_:1},8,["loading"])])]),default:a(()=>[e(S,{model:o(d),ref_key:"formRef",ref:b,size:"default","label-width":"80px"},{default:a(()=>[e(L,{gutter:35},{default:a(()=>[e(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e(m,{label:"上级分组"},{default:a(()=>[e(i,{modelValue:o(d).parentId,"onUpdate:modelValue":l[0]||(l[0]=t=>o(d).parentId=t),data:g.permissionTreeData,"node-key":"id","check-strictly":"","default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",class:"w100"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e(m,{label:"视图"},{default:a(()=>[e(i,{modelValue:o(d).viewId,"onUpdate:modelValue":l[1]||(l[1]=t=>o(d).viewId=t),data:n.viewTreeData,"node-key":"id",props:{label:"path"},"default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",filterable:"","filter-node-method":A,class:"w100",onCurrentChange:h},{default:a(({data:t})=>[_("span",G,[_("span",null,w(t.label),1),_("span",{class:"my-line-1 my-ml-12",title:t.path},w(t.path),9,H)])]),_:1},8,["modelValue","data"])]),_:1})]),_:1}),e(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e(m,{label:"名称",prop:"label",rules:[{required:!0,message:"请输入名称",trigger:["blur","change"]}]},{default:a(()=>[e(p,{modelValue:o(d).label,"onUpdate:modelValue":l[2]||(l[2]=t=>o(d).label=t),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e(m,{label:"路由地址",prop:"path",rules:[{required:!0,message:"请输入路由地址",trigger:["blur","change"]}]},{default:a(()=>[e(p,{modelValue:o(d).path,"onUpdate:modelValue":l[3]||(l[3]=t=>o(d).path=t),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e(m,{label:"路由命名"},{default:a(()=>[e(p,{modelValue:o(d).name,"onUpdate:modelValue":l[4]||(l[4]=t=>o(d).name=t),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e(m,{label:"图标",prop:"icon"},{default:a(()=>[e(o(U),{modelValue:o(d).icon,"onUpdate:modelValue":l[5]||(l[5]=t=>o(d).icon=t),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"排序"},{default:a(()=>[e(M,{modelValue:o(d).sort,"onUpdate:modelValue":l[6]||(l[6]=t=>o(d).sort=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"启用"},{default:a(()=>[e(f,{modelValue:o(d).enabled,"onUpdate:modelValue":l[7]||(l[7]=t=>o(d).enabled=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:24,md:24,lg:24,xl:24},{default:a(()=>[e(m,{label:"链接地址"},{default:a(()=>[e(p,{modelValue:o(d).link,"onUpdate:modelValue":l[8]||(l[8]=t=>o(d).link=t),clearable:"",placeholder:"内嵌/外链链接地址"},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"内嵌窗口"},{default:a(()=>[e(f,{modelValue:o(d).isIframe,"onUpdate:modelValue":l[9]||(l[9]=t=>o(d).isIframe=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"缓存"},{default:a(()=>[e(f,{modelValue:o(d).isKeepAlive,"onUpdate:modelValue":l[10]||(l[10]=t=>o(d).isKeepAlive=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"固定"},{default:a(()=>[e(f,{modelValue:o(d).isAffix,"onUpdate:modelValue":l[11]||(l[11]=t=>o(d).isAffix=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"隐藏"},{default:a(()=>[e(f,{modelValue:o(d).hidden,"onUpdate:modelValue":l[12]||(l[12]=t=>o(d).hidden=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"新窗口"},{default:a(()=>[e(f,{modelValue:o(d).newWindow,"onUpdate:modelValue":l[13]||(l[13]=t=>o(d).newWindow=t)},null,8,["modelValue"])]),_:1})]),_:1}),e(r,{xs:24,sm:12,md:12,lg:12,xl:12},{default:a(()=>[e(m,{label:"链接外显"},{default:a(()=>[e(f,{modelValue:o(d).external,"onUpdate:modelValue":l[14]||(l[14]=t=>o(d).external=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const fe=j(Z,[["__scopeId","data-v-219fe56f"]]);export{fe as default};
