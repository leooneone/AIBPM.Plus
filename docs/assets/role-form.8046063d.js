import{R as p}from"./Role.ffc550a0.js";import{e as S}from"./mitt.7f99bbc0.js";import{c as z}from"./cloneDeep.d5c086cd.js";import{d as b,r as B,O as L,K as N,S as d,e as c,f as T,z as o,m as l,g as A,u as r,l as x,t as w,x as y}from"./vue.72f2672d.js";import"./http-client.193f2c5b.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";import"./_Uint8Array.e4cf923d.js";import"./_initCloneObject.7b8933bc.js";const M={class:"dialog-footer"},q=y("取 消"),E=y("确 定"),K=b({name:"admin/role/form"}),Z=b({...K,props:{title:{type:String,default:""},roleTreeData:{type:Array,default:()=>[]}},setup(_,{expose:k}){const g=B(),t=L({showDialog:!1,sureLoading:!1,form:{}}),{form:a}=N(t),D=async(s={id:0})=>{let e=z(s);if(s.id>0){const m=await new p().get({id:s.id},{loading:!0});m!=null&&m.success&&(e=m.data,e.parentId=e.parentId&&e.parentId>0?e.parentId:void 0)}t.form=e,t.showDialog=!0},I=()=>{t.showDialog=!1},v=()=>{g.value.validate(async s=>{if(!s)return;t.sureLoading=!0;let e={};t.form.parentId=t.form.parentId&&t.form.parentId>0?t.form.parentId:void 0,t.form.id!=null&&t.form.id>0?e=await new p().update(t.form,{showSuccessMessage:!0}):e=await new p().add(t.form,{showSuccessMessage:!0}),t.sureLoading=!1,e!=null&&e.success&&(S.emit("refreshRole"),t.showDialog=!1)})};return k({open:D}),(s,e)=>{const m=d("el-tree-select"),i=d("el-form-item"),u=d("el-col"),f=d("el-input"),h=d("el-input-number"),C=d("el-row"),R=d("el-form"),V=d("el-button"),U=d("el-dialog");return c(),T("div",null,[o(U,{modelValue:t.showDialog,"onUpdate:modelValue":e[5]||(e[5]=n=>t.showDialog=n),"destroy-on-close":"",title:_.title,draggable:"",width:"600px"},{footer:l(()=>[A("span",M,[o(V,{onClick:I,size:"default"},{default:l(()=>[q]),_:1}),o(V,{type:"primary",onClick:v,size:"default",loading:t.sureLoading},{default:l(()=>[E]),_:1},8,["loading"])])]),default:l(()=>[o(R,{model:r(a),ref_key:"formRef",ref:g,size:"default","label-width":"80px"},{default:l(()=>[o(C,{gutter:35},{default:l(()=>[o(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[o(i,{label:"上级分组"},{default:l(()=>[o(m,{modelValue:r(a).parentId,"onUpdate:modelValue":e[0]||(e[0]=n=>r(a).parentId=n),data:_.roleTreeData,"node-key":"id",props:{label:"name"},"check-strictly":"","default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",class:"w100"},null,8,["modelValue","data"])]),_:1})]),_:1}),o(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[o(i,{label:"名称",prop:"name",rules:[{required:!0,message:"请输入名称",trigger:["blur","change"]}]},{default:l(()=>[o(f,{modelValue:r(a).name,"onUpdate:modelValue":e[1]||(e[1]=n=>r(a).name=n),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),r(a).type===2?(c(),x(u,{key:0,xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[o(i,{label:"编码",prop:"code"},{default:l(()=>[o(f,{modelValue:r(a).code,"onUpdate:modelValue":e[2]||(e[2]=n=>r(a).code=n),clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):w("",!0),o(u,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[o(i,{label:"排序"},{default:l(()=>[o(h,{modelValue:r(a).sort,"onUpdate:modelValue":e[3]||(e[3]=n=>r(a).sort=n)},null,8,["modelValue"])]),_:1})]),_:1}),r(a).type===2?(c(),x(u,{key:1,xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[o(i,{label:"说明"},{default:l(()=>[o(f,{modelValue:r(a).description,"onUpdate:modelValue":e[4]||(e[4]=n=>r(a).description=n),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})):w("",!0)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{Z as default};
