import{_ as w}from"./ai-form-3baf0d65.js";import{k as A,h as ee,e as F,l as te,i as oe,E as ie,m as a,$ as C,o as s,c as x,p as n,y as i,Y as ne,am as re,G as l,M as R,D as p,u as m,x as _,v as c,R as M}from"./@vue-8306d5ee.js";import{P as $}from"./Permission-5cf8226b.js";import{M as ae,e as E,O as se,P as G}from"./index-0ce5277f.js";import{a as f}from"./authFunction-ba07a050.js";import{j as k}from"./lodash-es-f559e892.js";import"./element-plus-e21f9b5a.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const le={class:"my-layout"},pe={key:0},me={key:1},de=A({name:"admin/permission"}),Se=A({...de,setup(ce){const I=M(()=>w(()=>import("./permission-group-form-e0649661.js"),["assets/js/permission-group-form-e0649661.js","assets/js/ai-form-3baf0d65.js","assets/js/@vue-8306d5ee.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/Permission-5cf8226b.js","assets/js/index-0ce5277f.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css","assets/js/View-4d5a7440.js"])),K=M(()=>w(()=>import("./permission-menu-form-164b6554.js"),["assets/js/permission-menu-form-164b6554.js","assets/js/ai-form-3baf0d65.js","assets/js/@vue-8306d5ee.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/Permission-5cf8226b.js","assets/js/index-0ce5277f.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css","assets/js/View-4d5a7440.js","assets/css/permission-menu-form-81f3ab22.css"])),O=M(()=>w(()=>import("./permission-dot-form-2e421d7e.js"),["assets/js/permission-dot-form-2e421d7e.js","assets/js/Permission-5cf8226b.js","assets/js/index-0ce5277f.js","assets/js/@vue-8306d5ee.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/ai-form-3baf0d65.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css","assets/js/Api-09cff6ae.js","assets/css/permission-dot-form-361674a5.css"])),{proxy:B}=ee(),T=F(),D=F(),g=F(),t=te({loading:!1,permissionFormTitle:"",filter:{name:""},permissionTreeData:[],formPermissionGroupTreeData:[],formPermissionMenuTreeData:[],expandRowKeys:[]});oe(async()=>{await y(),t.expandRowKeys=ae(k(t.permissionTreeData)).filter(o=>o.opened===!0).map(o=>o.id+""),E.off("refreshPermission"),E.on("refreshPermission",async()=>{y()})}),ie(()=>{E.off("refreshPermission")});const y=async()=>{t.loading=!0;const o=await new $().getList().catch(()=>{t.loading=!1});o&&o.data&&o.data.length>0?(t.permissionTreeData=se(G(k(o.data)),t.filter.name,{filterWhere:(r,v)=>{var h,d;return((h=r.label)==null?void 0:h.toLocaleLowerCase().indexOf(v))>-1||((d=r.path)==null?void 0:d.toLocaleLowerCase().indexOf(v))>-1}}),t.formPermissionGroupTreeData=G(k(o.data).filter(r=>r.type===1)),t.formPermissionMenuTreeData=G(k(o.data).filter(r=>r.type===1||r.type===2))):(t.permissionTreeData=[],t.formPermissionGroupTreeData=[],t.formPermissionMenuTreeData=[]),t.loading=!1},b=o=>{switch(o){case 1:t.permissionFormTitle="新增分组",T.value.open();break;case 2:t.permissionFormTitle="新增菜单",D.value.open();break;case 3:t.permissionFormTitle="新增权限点",g.value.open();break}},S=o=>{switch(o.type){case 1:t.permissionFormTitle="编辑分组",T.value.open(o);break;case 2:t.permissionFormTitle="编辑菜单",D.value.open(o);break;case 3:t.permissionFormTitle="编辑权限点",g.value.open(o);break}},N=o=>{B.$modal.confirmDelete(`确定要删除${o.type===1?"分组":o.type===2?"菜单":o.type===3?"权限点":""}【${o.label}】?`).then(async()=>{await new $().delete({id:o.id},{loading:!0}),y()}).catch(()=>{})};return(o,r)=>{const v=a("el-input"),h=a("el-form-item"),d=a("el-button"),z=a("ele-ArrowDown"),j=a("el-icon"),P=a("el-dropdown-item"),Q=a("el-dropdown-menu"),U=a("el-dropdown"),W=a("el-form"),L=a("el-card"),Y=a("SvgIcon"),u=a("el-table-column"),V=a("el-tag"),q=a("el-table"),H=C("auths"),J=C("auth"),X=C("loading");return s(),x("div",le,[n(L,{class:"mt8",shadow:"never","body-style":{paddingBottom:"0"}},{default:i(()=>[n(W,{inline:!0,onSubmit:r[4]||(r[4]=ne(()=>{},["stop","prevent"]))},{default:i(()=>[n(h,{label:"权限名称"},{default:i(()=>[n(v,{modelValue:t.filter.name,"onUpdate:modelValue":r[0]||(r[0]=e=>t.filter.name=e),placeholder:"权限名称",onKeyup:re(y,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),n(h,null,{default:i(()=>[n(d,{type:"primary",icon:"ele-Search",onClick:y},{default:i(()=>[l(" 查询 ")]),_:1}),R((s(),p(U,{style:{"margin-left":"12px"}},{dropdown:i(()=>[n(Q,null,{default:i(()=>[m(f)("api:admin:permission:addgroup")?(s(),p(P,{key:0,onClick:r[1]||(r[1]=e=>b(1))},{default:i(()=>[l("新增分组")]),_:1})):_("",!0),m(f)("api:admin:permission:addmenu")?(s(),p(P,{key:1,onClick:r[2]||(r[2]=e=>b(2))},{default:i(()=>[l("新增菜单")]),_:1})):_("",!0),m(f)("api:admin:permission:adddot")?(s(),p(P,{key:2,onClick:r[3]||(r[3]=e=>b(3))},{default:i(()=>[l("新增权限点")]),_:1})):_("",!0)]),_:1})]),default:i(()=>[n(d,{type:"primary"},{default:i(()=>[l("新增"),n(j,{class:"el-icon--right"},{default:i(()=>[n(z)]),_:1})]),_:1})]),_:1})),[[H,["api:admin:permission:addgroup","api:admin:permission:addmenu","api:admin:permission:adddot"]]])]),_:1})]),_:1})]),_:1}),n(L,{class:"my-fill mt8",shadow:"never"},{default:i(()=>[R((s(),p(q,{data:t.permissionTreeData,style:{width:"100%"},"row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},"expand-row-keys":t.expandRowKeys},{default:i(()=>[n(u,{prop:"label",label:"权限名称",width:"240","show-overflow-tooltip":""},{default:i(({row:e})=>[n(Y,{name:e.icon},null,8,["name"]),l(" "+c(e.label),1)]),_:1}),n(u,{prop:"type",label:"类型",width:"80","show-overflow-tooltip":""},{default:i(({row:e})=>[l(c(e.type===1?"分组":e.type===2?"菜单":e.type===3?"权限点":""),1)]),_:1}),n(u,{prop:"path",label:"权限地址","min-width":"240","show-overflow-tooltip":""},{default:i(({row:e})=>[e.type===1||e.type===2?(s(),x("div",pe,c(e.path?"路由地址："+e.path:"")+" "+c(e.viewPath?"视图地址："+e.viewPath:"")+" "+c(e.redirect?"重定向地址："+e.redirect:"")+" "+c(e.link?"链接地址："+e.link:""),1)):_("",!0),e.type===3?(s(),x("div",me,"接口地址："+c(e.apiPaths),1)):_("",!0)]),_:1}),n(u,{prop:"sort",label:"排序",width:"80",align:"center","show-overflow-tooltip":""}),n(u,{label:"状态",width:"80",align:"center","show-overflow-tooltip":""},{default:i(({row:e})=>[e.enabled?(s(),p(V,{key:0,type:"success"},{default:i(()=>[l("启用")]),_:1})):(s(),p(V,{key:1,type:"danger"},{default:i(()=>[l("禁用")]),_:1}))]),_:1}),n(u,{label:"操作",width:"160",fixed:"right","header-align":"center",align:"center"},{default:i(({row:e})=>[e.type===1&&m(f)("api:admin:permission:updategroup")||e.type===2&&m(f)("api:admin:permission:updatemenu")||e.type===3&&m(f)("api:admin:permission:updatedot")?(s(),p(d,{key:0,icon:"ele-EditPen",size:"small",text:"",type:"primary",onClick:Z=>S(e)},{default:i(()=>[l("编辑")]),_:2},1032,["onClick"])):_("",!0),R((s(),p(d,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:Z=>N(e)},{default:i(()=>[l("删除")]),_:2},1032,["onClick"])),[[J,"api:admin:permission:delete"]])]),_:1})]),_:1},8,["data","expand-row-keys"])),[[X,t.loading]])]),_:1}),n(m(I),{ref_key:"permissionGroupFormRef",ref:T,title:t.permissionFormTitle,"permission-tree-data":t.formPermissionGroupTreeData},null,8,["title","permission-tree-data"]),n(m(K),{ref_key:"permissionMenuFormRef",ref:D,title:t.permissionFormTitle,"permission-tree-data":t.formPermissionGroupTreeData},null,8,["title","permission-tree-data"]),n(m(O),{ref_key:"permissionDotFormRef",ref:g,title:t.permissionFormTitle,"permission-tree-data":t.formPermissionMenuTreeData},null,8,["title","permission-tree-data"])])}}});export{Se as default};
