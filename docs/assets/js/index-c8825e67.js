import T from"./Permission-f5caa05a.js";import{_ as S}from"./Operation.vue_vue_type_script_setup_true_lang-4c13af3b.js";import O from"./Participant-3a015892.js";import z from"./Condition-747a2bf2.js";import U from"./Circulate-b6f70c3d.js";import{C as j}from"./element-plus-e21f9b5a.js";import{m as t,o as r,D as p,a0 as J,y as o,G as m,v as B,M as C,N,a as v,p as l,x as d,c as h}from"./@vue-8306d5ee.js";import{_ as M}from"./index-c27e5712.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-97a12f88.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const G={inject:["titleChange"],directives:{ClickOutside:j},components:{PermissionPanel:T,ParticipantPanel:O,ConditionPanel:z,CirculatePanel:U,OperationPanel:S},props:{fields:{type:Array,default:()=>{}},conditions:{type:Array,default:()=>{}},node:{type:Object,default:()=>{}}},data(){return{titleInputVisible:!1,curNode:{},isDrawer:!1,workflowTypes:[{label:"开始",value:"start"},{label:"结束",value:"end"},{label:"条件",value:"condition"},{label:"传阅",value:"circulate"},{label:"审批",value:"approver"}]}},watch:{isDrawer(a){a?this.$nextTick(()=>{this.curNode=JSON.parse(JSON.stringify(this.node))}):this.curNode={}}},methods:{showTitleInput(){this.titleInputVisible=!0,this.$nextTick(()=>this.$refs.titleInput.focus())},onTitleChange(){this.titleChange(this.curNode.title),this.titleInputVisible=!1},onConfirm(){var a,i,n,_,e;this.node.approve=(a=this.$refs.approvePanel)==null?void 0:a.onConfirm(),this.node.permission=(i=this.$refs.permissionPanel)==null?void 0:i.onConfirm(),this.node.condition=(n=this.$refs.conditionPanel)==null?void 0:n.onConfirm(),this.node.circulate=(_=this.$refs.circulatePanel)==null?void 0:_.onConfirm(),this.node.operation=(e=this.$refs.operationPanel)==null?void 0:e.onConfirm(),console.log("  panel confirmed"),this.close()},close(){this.isDrawer=!1},open(){this.isDrawer=!0,this.$nextTick(()=>{})}}};const L={key:0},q={key:1},H={key:2};const K={style:{flex:"auto"}};function Q(a,i,n,_,e,s){const E=t("ele-Edit"),k=t("el-icon"),b=t("el-input"),F=t("condition-panel"),u=t("el-tab-pane"),w=t("participant-panel"),D=t("permission-panel"),V=t("circulate-panel"),x=t("operation-panel"),R=t("el-option"),W=t("el-select"),A=t("el-tabs"),y=t("el-button"),P=t("el-drawer");return r(),p(P,{class:"myProp",title:"$t('message.layout.configTitle')",modelValue:e.isDrawer,"onUpdate:modelValue":i[3]||(i[3]=c=>e.isDrawer=c),direction:"rtl",isModal:"false","destroy-on-close":"",size:"600px"},J({footer:o(()=>[v("div",K,[l(y,{onClick:s.close},{default:o(()=>[m("取消")]),_:1},8,["onClick"]),l(y,{type:"primary",onClick:s.onConfirm},{default:o(()=>[m("确定")]),_:1},8,["onClick"])])]),default:o(()=>[l(A,{type:"border-card",style:{height:"calc(100vh - 5px)"}},{default:o(()=>[e.curNode.type==="condition"?(r(),p(u,{key:0,label:"条件"},{default:o(()=>[l(F,{ref:"conditionPanel",fields:n.fields,conditions:n.conditions,data:e.curNode.condition},null,8,["fields","conditions","data"])]),_:1})):d("",!0),["approve","deal"].includes(e.curNode.type)?(r(),p(u,{key:1,label:"参与人设置"},{default:o(()=>[l(w,{ref:"approvePanel",fields:n.fields,data:e.curNode.approve},null,8,["fields","data"])]),_:1})):d("",!0),["approve","start","deal"].includes(e.curNode.type)?(r(),p(u,{key:2,label:"表单权限"},{default:o(()=>[l(D,{ref:"permissionPanel",fields:n.fields,data:e.curNode.permission},null,8,["fields","data"])]),_:1})):d("",!0),e.curNode.type==="circulate"?(r(),p(u,{key:3,label:"传阅"},{default:o(()=>[l(V,{ref:"circulatePanel",fields:n.fields,data:e.curNode.circulate},null,8,["fields","data"])]),_:1})):d("",!0),l(u,{label:"操作设置"},{default:o(()=>[l(x,{ref:"operationPanel",data:e.curNode.operation},null,8,["data"])]),_:1}),l(u,{label:"说明"},{default:o(()=>[e.curNode.type==="start"?(r(),h("div",L,"每个流程只允许一个启动节点")):e.curNode.type==="end"?(r(),h("div",q," 每个流程只允许一个结束节点； 结束节点可以有一条或者多条入向连接，但没有出向连接。 ")):(r(),h("div",H,"这里是节点说明"))]),_:1}),d("",!0)]),_:1})]),_:2},[e.curNode&&e.curNode.type=="start"?{name:"header",fn:o(({close:c,titleId:g,titleClass:I})=>[m(B(e.curNode.title),1)]),key:"0"}:{name:"header",fn:o(({close:c,titleId:g,titleClass:I})=>[C(v("span",{onClick:i[0]||(i[0]=(...f)=>s.showTitleInput&&s.showTitleInput(...f)),style:{cursor:"pointer"}},[m(B(e.curNode.title)+" ",1),l(k,{style:{"font-size":"1.5em"}},{default:o(()=>[l(E)]),_:1})],512),[[N,!e.titleInputVisible]]),C(l(b,{ref:"titleInput",size:"small",modelValue:e.curNode.title,"onUpdate:modelValue":i[1]||(i[1]=f=>e.curNode.title=f),placeholder:"请输入节点标签",onBlur:s.onTitleChange},null,8,["modelValue","onBlur"]),[[N,e.titleInputVisible]])]),key:"1"}]),1032,["title","modelValue"])}const De=M(G,[["render",Q]]);export{De as default};
