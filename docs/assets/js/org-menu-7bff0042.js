import{U as D,P as C}from"./index-c27e5712.js";import{g as w}from"./element-plus-e21f9b5a.js";import{k as p,e as K,l as V,f as N,i as b,n as M,m as i,$ as B,o as s,D as d,y as n,p as c,M as F,q as O,u as P}from"./@vue-8306d5ee.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-97a12f88.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./@intlify-869ec77a.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./@element-plus-8ef115d9.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./lodash-es-f559e892.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";import"./@vueuse-245b213e.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";const R=p({name:"admin/org/menu"}),se=p({...R,props:{modelValue:{default:()=>[]},selectFirstNode:{type:Boolean,default:!1}},emits:["node-click","update:modelValue"],setup(m,{expose:u,emit:l}){const f=m,r=K(),t=V({loading:!1,filterText:"",orgTreeData:[],lastKey:0});N(()=>t.filterText,e=>{var a;(a=r.value)==null||a.filter(e)}),b(()=>{_()});const g=(e,a)=>{var o;return e?((o=a.name)==null?void 0:o.indexOf(e))!==-1:!0},h=e=>{var a;t.lastKey===e.id?(t.lastKey=0,(a=r.value)==null||a.setCurrentKey(void 0),l("node-click",null)):(t.lastKey=e.id,l("node-click",e))},y=()=>{var e;l("update:modelValue",(e=r.value)==null?void 0:e.getCheckedKeys())},_=async()=>{t.loading=!0;const e=await new D().getList().catch(()=>{t.loading=!1});t.loading=!1,e!=null&&e.success&&e.data&&e.data.length>0?(t.orgTreeData=C(e.data),t.orgTreeData.length>0&&f.selectFirstNode&&M(()=>{var o;const a=t.orgTreeData[0];(o=r.value)==null||o.setCurrentKey(a.id),l("node-click",a)})):t.orgTreeData=[]};return u({orgMenuRef:r}),(e,a)=>{const o=i("el-input"),k=i("el-scrollbar"),x=i("el-card"),T=B("loading");return s(),d(x,{shadow:"never",style:{"margin-top":"8px"},"body-style":"padding:0px;",class:"my-fill"},{header:n(()=>[c(o,{modelValue:t.filterText,"onUpdate:modelValue":a[0]||(a[0]=v=>t.filterText=v),placeholder:"筛选部门",clearable:""},null,8,["modelValue"])]),default:n(()=>[F((s(),d(k,{height:"100%","max-height":"100%",always:!1,"wrap-style":"padding:var(--el-card-padding)"},{default:n(()=>[c(P(w),O({ref_key:"orgMenuRef",ref:r,data:t.orgTreeData,"node-key":"id",props:{children:"children",label:"name"},"filter-node-method":g,"highlight-current":"","check-strictly":"","default-expand-all":"","render-after-expand":"","expand-on-click-node":!1},e.$attrs,{onNodeClick:h,onCheckChange:y}),null,16,["data"])]),_:1})),[[T,t.loading]])]),_:1})}}});export{se as default};
