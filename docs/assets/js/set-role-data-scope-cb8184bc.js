import{_ as B}from"./ai-form-97a12f88.js";import{k as g,e as T,j as z,l as A,ah as E,m as n,o as d,D as u,y as s,a as M,p as r,G as _,u as i,c as U,H as F,F as O,M as P,N as j,R as G}from"./@vue-8306d5ee.js";import{W as f,_ as H}from"./index-c27e5712.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const K={class:"dialog-footer"},W=g({name:"admin/role/components/set-role-data-scope"}),$=g({...W,props:{title:{type:String,default:""}},setup(w,{expose:v}){const p=w,h=G(()=>B(()=>import("./org-menu-7bff0042.js"),["assets/js/org-menu-7bff0042.js","assets/js/index-c27e5712.js","assets/js/@vue-8306d5ee.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/ai-form-97a12f88.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css"])),k=T(),y=z(()=>p.title?p.title:e.roleName?`设置【${e.roleName}】数据权限`:"设置数据权限"),e=A({showDialog:!1,loading:!1,sureLoading:!1,permissionTreeData:[],roleId:0,roleName:"",checkedKeys:[],form:{},dataScopeList:[{label:"全部",value:1},{label:"本部门和下级部门",value:2},{label:"本部门",value:3},{label:"本人数据",value:4},{label:"指定部门",value:5}]}),{form:c}=E(e),b=async l=>{if(e.roleId=l.id,e.roleName=l.name,l.id>0){const o=await new f().get({id:l.id},{loading:!0});if(o!=null&&o.success){const t=o.data;e.form={roleId:t==null?void 0:t.id,dataScope:t==null?void 0:t.dataScope,orgIds:t==null?void 0:t.orgIds},e.showDialog=!0}}},S=()=>{e.showDialog=!1},D=()=>{e.showDialog=!1},V=async()=>{e.sureLoading=!0;const l=await new f().setDataScope(e.form,{showSuccessMessage:!0}).catch(()=>{e.sureLoading=!1});e.sureLoading=!1,l!=null&&l.success&&(e.showDialog=!1)};return v({open:b,close:S}),(l,o)=>{const t=n("el-option"),x=n("el-select"),I=n("el-form-item"),L=n("el-col"),R=n("el-row"),N=n("el-form"),m=n("el-button"),C=n("el-dialog");return d(),u(C,{modelValue:e.showDialog,"onUpdate:modelValue":o[2]||(o[2]=a=>e.showDialog=a),"destroy-on-close":"",title:y.value,"append-to-body":"",draggable:"","close-on-click-modal":!1,"close-on-press-escape":!1,width:"780px"},{footer:s(()=>[M("span",K,[r(m,{onClick:D,size:"default"},{default:s(()=>[_("取 消")]),_:1}),r(m,{type:"primary",onClick:V,size:"default",loading:e.sureLoading},{default:s(()=>[_("确 定")]),_:1},8,["loading"])])]),default:s(()=>[r(N,{model:i(c),ref:"formRef",size:"default","label-width":"80px","label-position":"top"},{default:s(()=>[r(R,{gutter:35},{default:s(()=>[r(L,{xs:24,sm:24,md:24,lg:24,xl:24},{default:s(()=>[r(I,{label:"数据范围"},{default:s(()=>[r(x,{key:"dataScope",modelValue:i(c).dataScope,"onUpdate:modelValue":o[0]||(o[0]=a=>i(c).dataScope=a),placeholder:"请选择",class:"w100"},{default:s(()=>[(d(!0),U(O,null,F(e.dataScopeList,a=>(d(),u(t,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),P(r(i(h),{ref_key:"orgRef",ref:k,"show-checkbox":"","check-on-click-node":"",modelValue:i(c).orgIds,"onUpdate:modelValue":o[1]||(o[1]=a=>i(c).orgIds=a),"default-checked-keys":i(c).orgIds,class:"w100"},null,8,["modelValue","default-checked-keys"]),[[j,i(c).dataScope===5]])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])}}});const ke=H($,[["__scopeId","data-v-3dd137f8"]]);export{ke as default};
