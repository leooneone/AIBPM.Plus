import{_ as R}from"./ai-form-7f0c78d7.js";import{b as W,v as j}from"./data-contracts-a56545c2.js";import{W as D}from"./WorkflowTemplate-0cd3c059.js";import{d as F}from"./dayjs-97457aaf.js";import{k as P,h as O,l as G,i as Q,m as r,$ as I,o as m,c as M,p as o,y as n,F as q,H as J,D as g,u as w,G as s,M as b,v as h,a as K,R as X}from"./@vue-8306d5ee.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./@intlify-869ec77a.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./http-client-ae6371dd.js";import"./axios-21b846bc.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./index-aa73a18b.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const Z={style:{padding:"0px 0px 8px 8px"}},ee={class:"my-flex my-flex-end",style:{"margin-top":"20px"}},te=P({name:"bpm/template"}),Ve=P({...te,setup(oe){X(()=>R(()=>import("./iframes-6d4f6959.js"),["assets/js/iframes-6d4f6959.js","assets/js/@vue-8306d5ee.js","assets/js/vue-router-c9c3da21.js"]));const{proxy:x}=O(),{dic_bpm_group:S}=x.$dict("bpm-group"),e=G({loading:!1,filterModel:{name:"",states:["0","1"]},total:0,pageInput:{currentPage:1,pageSize:10},listData:[]});Q(()=>{c()});const C=l=>{var a=0,i=document.createElement("iframe");i.style.zIndex="9999",i.style.position="absolute",i.style.top=a+"px",i.style.left=a+"px",i.setAttribute("frameborder","0");var d=function(){i.setAttribute("width",document.body.clientWidth-2*a),i.setAttribute("height",document.body.clientHeight-2*a)};window.addEventListener("resize",d),d();var f=function(y){y.data==="close"&&(window.removeEventListener("resize",d),window.removeEventListener("message",f),document.body.removeChild(i))};window.addEventListener("message",f),i.setAttribute("src",l),document.body.appendChild(i)},k=l=>{const a="/bpm/designer?id="+l.id;C(a)},E=()=>{C("/bpm/designer")},V=(l,a,i)=>F(i).format("YYYY-MM-DD HH:mm:ss"),c=async()=>{var a,i;e.loading=!0,e.pageInput.filter=e.filterModel;const l=await new D().getPage(e.pageInput);e.listData=((a=l==null?void 0:l.data)==null?void 0:a.list)??[],e.total=((i=l.data)==null?void 0:i.total)??0,e.loading=!1},$=l=>{x.$modal.confirmDelete(`确定要删除【${l.name}】模板?`).then(async()=>{await new D().delete({id:l.id},{loading:!0,showSuccessMessage:!0}),c()}).catch(()=>{})},A=l=>{e.pageInput.pageSize=l,c()},T=l=>{e.pageInput.currentPage=l,c()};return(l,a)=>{const i=r("el-input"),d=r("el-form-item"),f=r("el-option"),y=r("el-select"),u=r("el-button"),B=r("el-form"),z=r("el-card"),p=r("el-table-column"),L=r("el-link"),H=r("el-tag"),N=r("el-table"),U=r("el-pagination"),v=I("auth"),Y=I("loading");return m(),M("div",Z,[o(z,{shadow:"never","body-style":{paddingBottom:"0"},style:{"margin-top":"8px"}},{default:n(()=>[o(B,{model:e.filterModel,inline:!0},{default:n(()=>[o(d,{prop:"name"},{default:n(()=>[o(i,{modelValue:e.filterModel.name,"onUpdate:modelValue":a[0]||(a[0]=t=>e.filterModel.name=t),placeholder:"模板名称"},null,8,["modelValue"])]),_:1}),o(d,{prop:"name"},{default:n(()=>[o(y,{modelValue:e.filterModel.states,"onUpdate:modelValue":a[1]||(a[1]=t=>e.filterModel.states=t),clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":""},{default:n(()=>[(m(!0),M(q,null,J(w(W),(t,_)=>(m(),g(f,{key:t,label:_,value:t},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),o(d,null,{default:n(()=>[o(u,{type:"primary",icon:"ele-Search",onClick:c},{default:n(()=>[s(" 查询 ")]),_:1}),b((m(),g(u,{type:"success",icon:"ele-Plus",onClick:E},{default:n(()=>[s(" 新增 ")]),_:1})),[[v,"api:bpm:template:control"]])]),_:1})]),_:1},8,["model"])]),_:1}),o(z,{shadow:"never",style:{"margin-top":"8px"}},{default:n(()=>[b((m(),g(N,{data:e.listData,"row-key":"id",style:{width:"100%"},border:""},{default:n(()=>[o(p,{type:"index",width:"60",label:"序号"}),o(p,{prop:"name",label:"模板名称","min-width":"120","show-overflow-tooltip":""},{default:n(({row:t})=>[o(L,{onClick:_=>k(t)},{default:n(()=>[s(h(t.name),1)]),_:2},1032,["onClick"])]),_:1}),o(p,{prop:"groupId",label:"流程分组","show-overflow-tooltip":"",width:"120"},{default:n(({row:t})=>[s(h(w(S)[t.groupId]),1)]),_:1}),o(p,{prop:"version",width:"60",label:"版本"}),o(p,{prop:"state",label:"模板状态",width:"100"},{default:n(({row:t})=>[o(H,{type:"primary","disable-transitions":""},{default:n(()=>[s(h(w(j)[t.state]),1)]),_:2},1024)]),_:1}),o(p,{prop:"userName",label:"创建人","show-overflow-tooltip":"",width:"120"}),o(p,{prop:"createdTime",label:"创建时间",formatter:V,width:"180"}),o(p,{label:"操作",width:"180",fixed:"right","header-align":"center",align:"center"},{default:n(({row:t})=>[o(u,{icon:"ele-CaretRight",size:"small",text:"",type:"primary",onClick:_=>k(t)},{default:n(()=>[s("进入")]),_:2},1032,["onClick"]),b((m(),g(u,{icon:"ele-EditPen",size:"small",text:"",type:"primary",onClick:_=>l.onEdit(t)},{default:n(()=>[s("编辑")]),_:2},1032,["onClick"])),[[v,"api:bpm:template:control"]]),b((m(),g(u,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:_=>$(t)},{default:n(()=>[s("删除")]),_:2},1032,["onClick"])),[[v,"api:bpm:template:control"]])]),_:1})]),_:1},8,["data"])),[[Y,e.loading]]),K("div",ee,[o(U,{currentPage:e.pageInput.currentPage,"onUpdate:currentPage":a[2]||(a[2]=t=>e.pageInput.currentPage=t),"page-size":e.pageInput.pageSize,"onUpdate:pageSize":a[3]||(a[3]=t=>e.pageInput.pageSize=t),total:e.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:A,onCurrentChange:T,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])]),_:1})])}}});export{Ve as default};
