import{k as M,e as f,l as N,j as p,i as j,E as q,A as O,o,c as r,a as i,x as g,I as b,v as C,P as u,S as X,T as Y}from"./@vue-8306d5ee.js";import{_ as A}from"./index-aa73a18b.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-7f0c78d7.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const n=d=>(X("data-v-a12cfc7b"),d=d(),Y(),d),K={class:"captcha"},U=["src"],Z=["src"],J={key:2,class:"captcha_message"},Q={class:"captcha_message__icon"},$={key:0,width:"28",height:"28",viewBox:"0 0 28 28",xmlns:"http://www.w3.org/2000/svg"},ee=n(()=>i("g",{stroke:"#fff","stroke-width":"1.5",fill:"none","fill-rule":"evenodd","stroke-linecap":"round","stroke-linejoin":"round"},[i("path",{d:"M22.776 4.073A13.2 13.2 0 0 0 14 .75C6.682.75.75 6.682.75 14S6.682 27.25 14 27.25 27.25 21.318 27.25 14c0-.284-.009-.566-.027-.845"}),i("path",{d:"M7 12.5l7 7 13-13"})],-1)),te=[ee],se={key:1,width:"28",height:"28",viewBox:"0 0 28 28",xmlns:"http://www.w3.org/2000/svg"},ie=n(()=>i("g",{stroke:"#fff","stroke-width":"1.5",fill:"none","fill-rule":"evenodd"},[i("circle",{cx:"14",cy:"14",r:"13.25"}),i("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M8.75 8.75l10.5 10.5M19.25 8.75l-10.5 10.5"})],-1)),ae=[ie],oe={class:"captcha_message__text"},re={key:3,class:"captcha_message loadding"},ne=n(()=>i("div",{class:"captcha_message__icon captcha_message__icon--loadding"},null,-1)),de=n(()=>i("div",{class:"captcha_message__text"},"加载中...",-1)),ce=[ne,de],le={key:4,class:"captcha_message"},he=n(()=>i("div",{class:"captcha_message__icon captcha_message__icon--loadding"},null,-1)),pe=n(()=>i("div",{class:"captcha_message__text"},null,-1)),ge=[he,pe],ue={key:0,width:"16",height:"16",viewBox:"0 0 28 28",xmlns:"http://www.w3.org/2000/svg"},fe=n(()=>i("g",{stroke:"rgb(118, 198, 29)","stroke-width":"1.5",fill:"none","fill-rule":"evenodd","stroke-linecap":"round","stroke-linejoin":"round"},[i("path",{d:"M22.776 4.073A13.2 13.2 0 0 0 14 .75C6.682.75.75 6.682.75 14S6.682 27.25 14 27.25 27.25 21.318 27.25 14c0-.284-.009-.566-.027-.845"}),i("path",{d:"M7 12.5l7 7 13-13"})],-1)),_e=[fe],we=n(()=>i("path",{d:"M500.864 545.728a47.744 47.744 0 0 0 6.72-48.896 24.704 24.704 0 0 0-4.48-8.384L240.256 193.088a34.24 34.24 0 0 0-28.608-17.408 34.24 34.24 0 0 0-25.856 12.864 46.592 46.592 0 0 0 0 59.52l238.08 264.512-238.08 264.512a46.592 46.592 0 0 0-1.088 59.52 32 32 0 0 0 50.56 0l265.6-290.88z","p-id":"820"},null,-1)),me=n(()=>i("path",{d:"M523.84 248.064l236.992 264.512-238.08 264.512a46.592 46.592 0 0 0 0 59.52 32 32 0 0 0 50.56 0l265.6-292.608a47.744 47.744 0 0 0 6.72-48.832 24.704 24.704 0 0 0-4.48-8.448L578.304 191.36a34.24 34.24 0 0 0-55.552-2.816 46.592 46.592 0 0 0 1.088 59.52z","p-id":"821"},null,-1)),ve=[we,me],ye={key:0,class:"captcha__actions"},xe=n(()=>i("svg",{fill:"#FFF",width:"20px",height:"20px",viewBox:"0 0 20 20",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},[i("path",{d:"M10,4 C12.0559549,4 13.9131832,5.04358655 15.0015086,6.68322231 L15,5.5 C15,5.22385763 15.2238576,5 15.5,5 C15.7761424,5 16,5.22385763 16,5.5 L16,8.5 C16,8.77614237 15.7761424,9 15.5,9 L12.5,9 C12.2238576,9 12,8.77614237 12,8.5 C12,8.22385763 12.2238576,8 12.5,8 L14.5842317,8.00000341 C13.7999308,6.20218044 12.0143541,5 10,5 C7.23857625,5 5,7.23857625 5,10 C5,12.7614237 7.23857625,15 10,15 C11.749756,15 13.3431487,14.0944653 14.2500463,12.6352662 C14.3958113,12.4007302 14.7041063,12.328767 14.9386423,12.4745321 C15.1731784,12.6202971 15.2451415,12.9285921 15.0993765,13.1631281 C14.0118542,14.9129524 12.0990688,16 10,16 C6.6862915,16 4,13.3137085 4,10 C4,6.6862915 6.6862915,4 10,4 Z","fill-rule":"nonzero"})],-1)),ke=[xe],be=M({name:"my-slide-captcha"}),Se=M({...be,props:{width:{type:[Number,String],default:340},height:{type:[Number,String],default:212},barHeight:{type:Number,default:40},handlerIconWidth:{type:Number,default:16},handlerIconHeigth:{type:Number,default:16},background:{type:String,default:"#eee"},circle:{type:Boolean,default:!1},radius:{type:String,default:"4px"},text:{type:String,default:"按住滑块拖动"},progressBarBg:{type:String,default:"#76c61d"},successTip:{type:String,default:"验证通过"},failTip:{type:String,default:"验证未通过，拖动滑块将悬浮图像正确合并"},showRefresh:{type:Boolean,default:!0}},emits:["finish","refresh"],setup(d,{expose:H,emit:S}){const s=d,y=f(),c=f(),_=f(),l=f(),h=f(),e=N({isMoving:!1,x:0,y:0,isOk:!1,isKeep:!1,isFinish:!1,tracks:[],startSlidingTime:new Date,showVerifyTip:!1,showVerifyLoadding:!1,showGenerateLoadding:!1,src:"",sliderSrc:"",isPassing:!1,width:340}),T=p(()=>({width:s.width+"px",height:s.height+"px",overflow:"hidden"})),B=p(()=>({width:s.width+"px",height:s.barHeight+"px",lineHeight:s.barHeight+"px",background:s.background,borderRadius:s.circle?s.barHeight/2+"px":s.radius})),P=p(()=>({background:s.progressBarBg,height:s.barHeight+"px",borderRadius:s.circle?s.barHeight/2+"px 0 0 "+s.barHeight/2+"px":s.radius})),E=p(()=>({height:s.barHeight+"px",width:s.width+"px"})),V=p(()=>({width:s.barHeight+"px",height:s.barHeight+"px"})),F=p(()=>({width:s.handlerIconWidth+"px",height:s.handlerIconHeigth+"px"}));j(()=>{const t=_.value;t.style.setProperty("--textColor","#333");let a=t.clientWidth;a=a>0?a:e.width,t.style.setProperty("--width",Math.floor(a/2)+"px"),t.style.setProperty("--pwidth",-Math.floor(a/2)+"px"),document.documentElement.style.setProperty("--my-captcha-width",a+"px"),k()});const L=()=>{var a;const t=(a=_.value)==null?void 0:a.clientWidth;t>0&&document.documentElement.style.setProperty("--my-captcha-width",t+"px")};q(()=>{document.documentElement.style.setProperty("--my-captcha-width",e.width+"px"),window.addEventListener("resize",L)}),O(()=>{window.removeEventListener("resize",L)});const I=()=>{x(),e.showGenerateLoadding=!0},R=(t,a)=>{e.showGenerateLoadding=!1,e.src=t,e.sliderSrc=a},D=()=>{e.showVerifyLoadding=!0},W=t=>{e.isPassing=t,e.showVerifyLoadding=!1,e.showVerifyTip=!0},x=()=>{e.x=0,e.y=0,e.tracks=[],e.isMoving=!1,e.isFinish=!1,e.showGenerateLoadding=!1,e.showVerifyLoadding=!1,e.showVerifyTip=!1,e.isPassing=!1,l.value&&(l.value.style.width=0),c.value&&(c.value.style.left=0),h.value&&(h.value.style.left=0)},z=()=>{window.removeEventListener("touchmove",m),window.removeEventListener("touchend",v),window.removeEventListener("mousemove",m),window.removeEventListener("mouseup",v)},w=t=>{t==null||t.preventDefault(),!e.isPassing&&e.src&&e.sliderSrc&&!e.isFinish&&(window.addEventListener("touchmove",m),window.addEventListener("touchend",v),window.addEventListener("mousemove",m),window.addEventListener("mouseup",v),e.isMoving=!0,e.startSlidingTime=new Date,e.x=t.touches?t.touches[0].pageX:t.clientX,e.y=t.touches?t.touches[0].pageY:t.clientY,e.width=_.value.clientWidth)},m=t=>{if(t==null||t.preventDefault(),e.isMoving&&!e.isPassing&&e.src&&e.sliderSrc&&!e.isFinish){var a=(t.touches?t.touches[0].pageX:t.clientX)-e.x;if(a>0&&a<=e.width-s.barHeight){var G=(t.touches?t.touches[0].pageY:t.clientY)-e.y;h.value.style.left=a+"px",l.value.style.width=a+s.barHeight/2+"px",c.value.style.left=a+"px",e.tracks.push({x:Math.round(a),y:Math.round(G),t:new Date().getTime()-e.startSlidingTime.getTime()})}a<=0&&(h.value.style.left="0px",l.value.style.width="0px"),a>e.width-s.barHeight&&(h.value.style.left=e.width-s.barHeight+"px",l.value.style.width=e.width+s.barHeight/2+"px")}},v=t=>{t==null||t.preventDefault(),e.isMoving&&!e.isPassing&&e.src&&e.sliderSrc&&!e.isFinish&&(e.isMoving=!1,e.isFinish=!0,z(),e.tracks.length>0?S("finish",{backgroundImageWidth:y.value.offsetWidth,backgroundImageHeight:y.value.offsetHeight,sliderImageWidth:c.value.offsetWidth,sliderImageHeight:c.value.offsetHeight,startTime:e.startSlidingTime,endTime:new Date,tracks:e.tracks}):x())},k=()=>{x(),S("refresh")};return H({startRequestGenerate:I,endRequestGenerate:R,startRequestVerify:D,endRequestVerify:W,handleRefresh:k}),(t,a)=>(o(),r("div",K,[i("div",{class:"captcha__main",style:u(T.value)},[e.src?(o(),r("img",{key:0,src:e.src,class:"captcha_background",alt:"background",ref_key:"backgroundRef",ref:y},null,8,U)):g("",!0),e.sliderSrc?(o(),r("img",{key:1,src:e.sliderSrc,class:b(["captcha_slider",{goFirst:e.isOk,goKeep:e.isKeep}]),alt:"slider",ref_key:"slider",ref:c,onMousedown:w,onTouchstart:w},null,42,Z)):g("",!0),e.showVerifyTip?(o(),r("div",J,[i("div",Q,[e.isPassing?(o(),r("svg",$,te)):(o(),r("svg",se,ae))]),i("div",oe,C(e.isPassing?d.successTip:d.failTip),1)])):g("",!0),e.showGenerateLoadding?(o(),r("div",re,ce)):g("",!0),e.showVerifyLoadding?(o(),r("div",le,ge)):g("",!0)],4),i("div",{class:"captcha__bar",style:u(B.value),ref_key:"dragVerify",ref:_},[i("div",{class:b(["captcha_progress_bar",{goFirst2:e.isOk}]),ref_key:"progressBar",ref:l,style:u(P.value)},null,6),i("div",{class:"captcha_progress_bar__text",style:u(E.value)},C(e.tracks.length>0||e.isPassing?"":d.text),5),i("div",{class:b(["captcha_handler",{goFirst:e.isOk}]),style:u(V.value),ref_key:"handler",ref:h,onMousedown:w,onTouchstart:w},[e.isPassing?(o(),r("svg",ue,_e)):(o(),r("svg",{key:1,style:u(F.value),viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"819"},ve,4))],38)],4),d.showRefresh&&!e.isPassing?(o(),r("div",ye,[i("a",{class:"captcha__action",onClick:k},ke)])):g("",!0)]))}});const Je=A(Se,[["__scopeId","data-v-a12cfc7b"]]);export{Je as default};
