import{W as c,e as R}from"./index-aa73a18b.js";import{j as B}from"./lodash-es-f559e892.js";import{k as b,e as N,l as S,ah as z,m as n,o as u,c as T,p as t,y as l,a as q,G as y,u as r,D as _,x as g}from"./@vue-8306d5ee.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-7f0c78d7.js";import"./element-plus-e21f9b5a.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const A={class:"dialog-footer"},M=b({name:"admin/role/form"}),pe=b({...M,props:{title:{type:String,default:""},roleTreeData:{type:Array,default:()=>[]}},setup(V,{expose:k}){const x=N(),o=S({showDialog:!1,sureLoading:!1,form:{}}),{form:a}=z(o),D=async(d={id:0})=>{let e=B(d);if(d.id>0){const m=await new c().get({id:d.id},{loading:!0});m!=null&&m.success&&(e=m.data,e.parentId=e.parentId&&e.parentId>0?e.parentId:void 0)}o.form=e,o.showDialog=!0},I=()=>{o.showDialog=!1},h=()=>{x.value.validate(async d=>{if(!d)return;o.sureLoading=!0;let e={};o.form.parentId=o.form.parentId&&o.form.parentId>0?o.form.parentId:void 0,o.form.id!=null&&o.form.id>0?e=await new c().update(o.form,{showSuccessMessage:!0}).catch(()=>{o.sureLoading=!1}):e=await new c().add(o.form,{showSuccessMessage:!0}).catch(()=>{o.sureLoading=!1}),o.sureLoading=!1,e!=null&&e.success&&(R.emit("refreshRole"),o.showDialog=!1)})};return k({open:D}),(d,e)=>{const m=n("el-tree-select"),i=n("el-form-item"),p=n("el-col"),f=n("el-input"),v=n("el-input-number"),C=n("el-row"),L=n("el-form"),w=n("el-button"),U=n("el-dialog");return u(),T("div",null,[t(U,{modelValue:o.showDialog,"onUpdate:modelValue":e[5]||(e[5]=s=>o.showDialog=s),"destroy-on-close":"",title:V.title,draggable:"","close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px"},{footer:l(()=>[q("span",A,[t(w,{onClick:I,size:"default"},{default:l(()=>[y("取 消")]),_:1}),t(w,{type:"primary",onClick:h,size:"default",loading:o.sureLoading},{default:l(()=>[y("确 定")]),_:1},8,["loading"])])]),default:l(()=>[t(L,{model:r(a),ref_key:"formRef",ref:x,size:"default","label-width":"80px"},{default:l(()=>[t(C,{gutter:35},{default:l(()=>[r(a).type===2?(u(),_(p,{key:0,xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t(i,{label:"上级分组",prop:"parentId",rules:[{required:!0,message:"请选择上级分组",trigger:["change"]}]},{default:l(()=>[t(m,{modelValue:r(a).parentId,"onUpdate:modelValue":e[0]||(e[0]=s=>r(a).parentId=s),data:V.roleTreeData,"node-key":"id",props:{label:"name"},"check-strictly":"","default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",class:"w100"},null,8,["modelValue","data"])]),_:1})]),_:1})):g("",!0),t(p,{xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t(i,{label:"名称",prop:"name",rules:[{required:!0,message:"请输入名称",trigger:["blur","change"]}]},{default:l(()=>[t(f,{modelValue:r(a).name,"onUpdate:modelValue":e[1]||(e[1]=s=>r(a).name=s),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),r(a).type===2?(u(),_(p,{key:1,xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t(i,{label:"编码",prop:"code"},{default:l(()=>[t(f,{modelValue:r(a).code,"onUpdate:modelValue":e[2]||(e[2]=s=>r(a).code=s),clearable:""},null,8,["modelValue"])]),_:1})]),_:1})):g("",!0),t(p,{xs:24,sm:12,md:12,lg:12,xl:12},{default:l(()=>[t(i,{label:"排序"},{default:l(()=>[t(v,{modelValue:r(a).sort,"onUpdate:modelValue":e[3]||(e[3]=s=>r(a).sort=s)},null,8,["modelValue"])]),_:1})]),_:1}),r(a).type===2?(u(),_(p,{key:2,xs:24,sm:24,md:24,lg:24,xl:24},{default:l(()=>[t(i,{label:"说明"},{default:l(()=>[t(f,{modelValue:r(a).description,"onUpdate:modelValue":e[4]||(e[4]=s=>r(a).description=s),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})):g("",!0)]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{pe as default};
