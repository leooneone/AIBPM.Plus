import{T as p}from"./Tenant-cd8a3a03.js";import{P as I}from"./Pkg-e8a6aa3b.js";import{t as M,a as S,b as T}from"./test-fb6d7fa5.js";import{e as z}from"./index-0ce5277f.js";import{k as b,h as P,e as R,l as A,ah as E,m as n,o as f,c as _,p as l,y as t,a as F,G as V,u as r,F as G,H,D as $}from"./@vue-8306d5ee.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-3baf0d65.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const j={class:"dialog-footer"},J=b({name:"admin/tenant/form"}),he=b({...J,props:{title:{type:String,default:""}},setup(x,{expose:w}){const{proxy:k}=P(),g=R(),o=A({showDialog:!1,sureLoading:!1,pkgData:[],form:{}}),{form:s}=E(o),h=async()=>{const m=await new I().getList().catch(()=>{o.pkgData=[]});o.pkgData=(m==null?void 0:m.data)??[]},y=async(m={})=>{if(await h(),m.id>0){const e=await new p().get({id:m.id},{loading:!0}).catch(()=>{k.$modal.closeLoading()});e!=null&&e.success&&(o.form=e.data)}else o.form={pkgIds:[],enabled:!0};o.showDialog=!0},D=()=>{!o.form.userName&&o.form.phone&&T(o.form.phone)&&(o.form.userName=o.form.phone)},N=()=>{o.showDialog=!1},v=()=>{g.value.validate(async m=>{if(!m)return;o.sureLoading=!0;let e={};o.form.id!=null&&o.form.id>0?e=await new p().update(o.form,{showSuccessMessage:!0}).catch(()=>{o.sureLoading=!1}):e=await new p().add(o.form,{showSuccessMessage:!0}).catch(()=>{o.sureLoading=!1}),o.sureLoading=!1,e!=null&&e.success&&(z.emit("refreshTenant"),o.showDialog=!1)})};return w({open:y}),(m,e)=>{const i=n("el-input"),u=n("el-form-item"),d=n("el-col"),L=n("el-option"),U=n("el-select"),C=n("el-row"),B=n("el-form"),c=n("el-button"),q=n("el-dialog");return f(),_("div",null,[l(q,{modelValue:o.showDialog,"onUpdate:modelValue":e[8]||(e[8]=a=>o.showDialog=a),"destroy-on-close":"",title:x.title,draggable:"","close-on-click-modal":!1,"close-on-press-escape":!1,width:"769px"},{footer:t(()=>[F("span",j,[l(c,{onClick:N,size:"default"},{default:t(()=>[V("取 消")]),_:1}),l(c,{type:"primary",onClick:v,size:"default",loading:o.sureLoading},{default:t(()=>[V("确 定")]),_:1},8,["loading"])])]),default:t(()=>[l(B,{ref_key:"formRef",ref:g,model:r(s),size:"default","label-width":"80px"},{default:t(()=>[l(C,{gutter:35},{default:t(()=>[l(d,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(u,{label:"企业名称",prop:"name",rules:[{required:!0,message:"请输入企业名称",trigger:["blur","change"]}]},{default:t(()=>[l(i,{modelValue:r(s).name,"onUpdate:modelValue":e[0]||(e[0]=a=>r(s).name=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(u,{label:"企业编码",prop:"code",rules:[{required:!0,message:"请输入企业编码",trigger:["blur","change"]}]},{default:t(()=>[l(i,{modelValue:r(s).code,"onUpdate:modelValue":e[1]||(e[1]=a=>r(s).code=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(u,{label:"套餐",prop:"pkgIds"},{default:t(()=>[l(U,{modelValue:r(s).pkgIds,"onUpdate:modelValue":e[2]||(e[2]=a=>r(s).pkgIds=a),placeholder:"请选择套餐",clearable:"",multiple:"","collapse-tags":"","collapse-tags-tooltip":"",filterable:"",class:"w100"},{default:t(()=>[(f(!0),_(G,null,H(o.pkgData,a=>(f(),$(L,{key:a.id,label:a.name,value:a.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(u,{label:"姓名",prop:"realName",rules:[{required:!0,message:"请输入姓名",trigger:["blur","change"]}]},{default:t(()=>[l(i,{modelValue:r(s).realName,"onUpdate:modelValue":e[3]||(e[3]=a=>r(s).realName=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(u,{label:"手机号",prop:"phone",rules:[{required:!0,message:"请输入手机号",trigger:["blur","change"]},{validator:r(M),trigger:["blur","change"]}]},{default:t(()=>[l(i,{modelValue:r(s).phone,"onUpdate:modelValue":e[4]||(e[4]=a=>r(s).phone=a),autocomplete:"off",maxlength:"11",onBlur:D},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(u,{label:"账号",prop:"userName",rules:[{required:!0,message:"请输入管理员账号",trigger:["blur","change"]}]},{default:t(()=>[l(i,{modelValue:r(s).userName,"onUpdate:modelValue":e[5]||(e[5]=a=>r(s).userName=a),autocomplete:"off"},null,8,["modelValue"])]),_:1})]),_:1}),l(d,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(u,{label:"邮箱",prop:"email",rules:[{validator:r(S),trigger:["blur","change"]}]},{default:t(()=>[l(i,{modelValue:r(s).email,"onUpdate:modelValue":e[6]||(e[6]=a=>r(s).email=a),autocomplete:"off"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1}),l(d,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(u,{label:"说明"},{default:t(()=>[l(i,{modelValue:r(s).description,"onUpdate:modelValue":e[7]||(e[7]=a=>r(s).description=a),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{he as default};
