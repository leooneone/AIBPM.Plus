import{_ as M}from"./ai-form-3baf0d65.js";import{k as T,h as R,e as K,l as N,i as z,E as L,m as l,$ as w,o as n,c as S,p as t,y as o,Y as U,am as G,G as s,M as v,D as m,u as f,x as b,R as Q}from"./@vue-8306d5ee.js";import{e as u,U as k,O as Y,P as j}from"./index-1c0db287.js";import{a as C}from"./authFunction-56d45b41.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const q={class:"my-layout"},H=T({name:"admin/org"}),Te=T({...H,setup(J){const D=Q(()=>M(()=>import("./org-form-c41eb781.js"),["assets/js/org-form-c41eb781.js","assets/js/index-1c0db287.js","assets/js/@vue-8306d5ee.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/ai-form-3baf0d65.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css"])),{proxy:x}=R(),_=K(),e=N({loading:!1,orgFormTitle:"",filter:{name:""},orgTreeData:[]});z(()=>{d(),u.off("refreshOrg"),u.on("refreshOrg",()=>{d()})}),L(()=>{u.off("refreshOrg")});const d=async()=>{e.loading=!0;const a=await new k().getList().catch(()=>{e.loading=!1});a&&a.data&&a.data.length>0?e.orgTreeData=Y(j(a.data),e.filter.name):e.orgTreeData=[],e.loading=!1},F=()=>{e.orgFormTitle="新增部门",_.value.open()},O=a=>{e.orgFormTitle="编辑部门",_.value.open(a)},V=a=>{x.$modal.confirmDelete(`确定要删除部门【${a.name}】?`).then(async()=>{await new k().delete({id:a.id},{loading:!0}),d()}).catch(()=>{})};return(a,p)=>{const E=l("el-input"),g=l("el-form-item"),c=l("el-button"),B=l("el-form"),h=l("el-card"),i=l("el-table-column"),y=l("el-tag"),P=l("el-table"),$=w("auth"),A=w("loading");return n(),S("div",q,[t(h,{class:"mt8",shadow:"never","body-style":{paddingBottom:"0"}},{default:o(()=>[t(B,{inline:!0,onSubmit:p[1]||(p[1]=U(()=>{},["stop","prevent"]))},{default:o(()=>[t(g,{label:"部门名称"},{default:o(()=>[t(E,{modelValue:e.filter.name,"onUpdate:modelValue":p[0]||(p[0]=r=>e.filter.name=r),placeholder:"部门名称",onKeyup:G(d,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(g,null,{default:o(()=>[t(c,{type:"primary",icon:"ele-Search",onClick:d},{default:o(()=>[s(" 查询 ")]),_:1}),v((n(),m(c,{type:"primary",icon:"ele-Plus",onClick:F},{default:o(()=>[s(" 新增 ")]),_:1})),[[$,"api:admin:org:add"]])]),_:1})]),_:1})]),_:1}),t(h,{class:"my-fill mt8",shadow:"never"},{default:o(()=>[v((n(),m(P,{data:e.orgTreeData,style:{width:"100%"},"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:o(()=>[t(i,{prop:"name",label:"部门名称","min-width":"120","show-overflow-tooltip":""}),t(i,{prop:"code",label:"部门编码","min-width":"120","show-overflow-tooltip":""}),t(i,{prop:"value",label:"部门值","min-width":"80","show-overflow-tooltip":""}),t(i,{prop:"sort",label:"排序",width:"80",align:"center","show-overflow-tooltip":""}),t(i,{label:"状态",width:"80",align:"center","show-overflow-tooltip":""},{default:o(({row:r})=>[r.enabled?(n(),m(y,{key:0,type:"success"},{default:o(()=>[s("启用")]),_:1})):(n(),m(y,{key:1,type:"danger"},{default:o(()=>[s("禁用")]),_:1}))]),_:1}),t(i,{label:"操作",width:"160",fixed:"right","header-align":"center",align:"center"},{default:o(({row:r})=>[f(C)("api:admin:org:update")&&r.parentId>0?(n(),m(c,{key:0,icon:"ele-EditPen",size:"small",text:"",type:"primary",onClick:I=>O(r)},{default:o(()=>[s("编辑")]),_:2},1032,["onClick"])):b("",!0),f(C)("api:admin:org:delete")&&r.parentId>0?(n(),m(c,{key:1,icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:I=>V(r)},{default:o(()=>[s("删除")]),_:2},1032,["onClick"])):b("",!0)]),_:1})]),_:1},8,["data"])),[[A,e.loading]])]),_:1}),t(f(D),{ref_key:"orgFormRef",ref:_,title:e.orgFormTitle,"org-tree-data":e.orgTreeData},null,8,["title","org-tree-data"])])}}});export{Te as default};
