import{k as W,l as j,f as H,m as p,o as n,c as g,p as c,D as u,y as i,G as v,x as z,F as y,H as x,M as J,N as K,v as Q}from"./@vue-8306d5ee.js";import{_ as X}from"./index-c27e5712.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-97a12f88.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const Z={class:"my-condition"},ee={key:0},le=W({name:"condition"}),oe=W({...le,props:{fields:{type:Array,default(){return[]}},conditions:{type:Array,default(){return[]}},data:{type:Object,default(){return{isDefault:!0}}}},setup(A,{expose:N}){const f=A,a={equal:{label:"等于",value:"Equal"},notEqual:{label:"不等于",value:"NotEqual"},contains:{label:"包含",value:"Contains"},notContains:{label:"不包含",value:"NotContains"},startsWith:{label:"开始以",value:"StartsWith"},notStartsWith:{label:"开始不是以",value:"NotStartsWith"},endsWith:{label:"结束以",value:"EndsWith"},notEndsWith:{label:"结束不是以",value:"NotEndsWith"},lessThan:{label:"小于",value:"LessThan"},lessThanOrEqual:{label:"小于等于",value:"LessThanOrEqual"},greaterThan:{label:"大于",value:"GreaterThan"},greaterThanOrEqual:{label:"大于等于",value:"GreaterThanOrEqual"},dateRange:{label:"时间段",value:"dateRange"},any:{label:"在列表",value:"Any"},notAny:{label:"不在列表",value:"NotAny"}},Y={default:[a.equal],string:[a.equal,a.notEqual,a.contains,a.notContains,a.startsWith,a.notStartsWith,a.endsWith,a.notEndsWith],date:[a.equal,a.notEqual,a.lessThan,a.lessThanOrEqual,a.greaterThan,a.greaterThanOrEqual,a.dateRange],number:[a.equal,a.notEqual,a.lessThan,a.lessThanOrEqual,a.greaterThan,a.greaterThanOrEqual],bool:[a.equal]};let T={field:"",label:""};if(f.fields&&f.fields.length>0){const t=f.fields.find(l=>l.default===!0);t?T=t:T=f.fields[0]}const s=j({loading:!1,key:1,dataTree:{},defaultProps:{label:"",children:"filters"},operatorGroups:Y,firstField:T,datePickerOptions:{disabledDate(t){return t.getTime()>Date.now()}}});H(()=>f.data,t=>{s.dataTree=t.root===void 0?{root:!0,logic:"And",filters:[]}:t},{deep:!0,immediate:!0});const G=()=>{if(f.data.isDefault||!s.dataTree.filters||s.dataTree.filters.length==0)return{isDefault:!0};var t={...s.dataTree,isDefault:f.data.isDefault};return t},h=t=>{const l=s.operatorGroups[t||""];return l&&l.length>0?l:s.operatorGroups.default},M=(t,l)=>{if(f.fields===void 0)return;const r=f.fields.find(m=>m.vModel===t);l.value="",l.label=r.label,l.tag=r.tag,l.type=r.dataType?r.dataType:"",l.options=r.options;const _=h(l.type);let d="";if(r.operator&&(d=_.findIndex(V=>V.value===r.operator)>=0?r.operator:""),d||(d=_[0].value),l.operator=d,l.config={...r.config},l.type==="date"){let m="date";l.operator==="dateRange"&&(m=m+"range"),l.config.type=l.config.type?l.config.type:m,l.config.type.indexOf("range")>=0&&(l.operator="dateRange"),l.config.format=l.config.format?l.config.format:"YYYY-MM-DD",l.config.valueFormat=l.config.valueFormat?l.config.valueFormat:"YYYY-MM-DD",l.config.defaultTime=l.config.defaultTime?l.config.defaultTime:["00:00:00","00:00:00"]}},I=(t,l)=>{l.type==="date"&&(s.key++,t==="dateRange"?(l.value="",l.config.type=l.config.type+"range"):l.config.type.indexOf("range")>=0&&(l.value="",l.config.type=l.config.type.replace(/range$/,"")))},P=t=>{const l={logic:"And"};t.filters||(t.filters=[]),t.filters.push(l)},R=t=>{const l=h(t.type)[0],r={field:s.firstField.field,label:s.firstField.label,operator:l.value,config:{...s.firstField.config},value:s.firstField.value};t.filters||(t.filters=[]);const _=t.filters.findIndex(d=>d.logic&&!d.field);_>=0?t.filters.splice(_,0,r):t.filters.push(r)},D=(t,l)=>{const r=t.parent,_=r.data.filters||r.data,d=_.findIndex(m=>m===l);_.splice(d,1)};return N({onConfirm:G}),(t,l)=>{const r=p("el-switch"),_=p("el-empty"),d=p("el-radio"),m=p("el-radio-group"),V=p("el-button"),O=p("ele-Delete"),E=p("el-icon"),C=p("el-option"),U=p("el-select"),b=p("el-col"),S=p("ai-ou-select"),F=p("el-input-number"),w=p("el-date-picker"),$=p("el-input"),L=p("el-row"),B=p("el-tree");return n(),g("section",Z,[c(r,{modelValue:f.data.isDefault,"onUpdate:modelValue":l[0]||(l[0]=k=>f.data.isDefault=k),"active-text":"默认/其他条件","inactive-text":"指定条件"},null,8,["modelValue"]),f.data.isDefault?(n(),u(_,{key:0,description:"无需配置条件"})):(n(),u(B,{key:1,data:[s.dataTree],props:s.defaultProps,"expand-on-click-node":!1,"default-expand-all":!0,indent:16,class:"my-search-filter"},{default:i(({node:k,data:e})=>[e.logic&&!e.field?(n(),g("span",ee,[c(m,{modelValue:e.logic,"onUpdate:modelValue":o=>e.logic=o},{default:i(()=>[c(d,{label:"And"},{default:i(()=>[v("并且")]),_:1}),c(d,{label:"Or"},{default:i(()=>[v("或者")]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),c(V,{type:"text",icon:"el-icon-plus",onClick:o=>P(e)},{default:i(()=>[v("分组")]),_:2},1032,["onClick"]),c(V,{type:"text",icon:"el-icon-plus",onClick:o=>R(e)},{default:i(()=>[v("条件")]),_:2},1032,["onClick"]),e.root?z("",!0):(n(),u(E,{key:0,onClick:o=>D(k,e),style:{"margin-left":"8px"}},{default:i(()=>[c(O)]),_:2},1032,["onClick"]))])):(n(),u(L,{key:1,gutter:5},{default:i(()=>[c(b,{span:8},{default:i(()=>[c(U,{modelValue:e.field,"onUpdate:modelValue":o=>e.field=o,loading:s.loading,filterable:"",onChange:o=>M(o,e)},{default:i(()=>[(n(!0),g(y,null,x(f.conditions,(o,q)=>(n(),u(C,{key:q,label:o.label,value:o.vModel},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","loading","onChange"])]),_:2},1024),J(c(b,{span:4},{default:i(()=>[c(U,{modelValue:e.operator,"onUpdate:modelValue":o=>e.operator=o,onChange:o=>I(o,e)},{default:i(()=>[(n(!0),g(y,null,x(h(e.type),(o,q)=>(n(),u(C,{key:q,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1536),[[K,h(e.type).length>1]]),c(b,{span:11},{default:i(()=>[e.tag==="ai-ou-select"?(n(),u(S,{key:0,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,tabList:["user"]},null,8,["modelValue","onUpdate:modelValue"])):e.tag==="fc-amount"||e.tag==="el-input-number"?(n(),u(F,{key:1,style:{"margin-left":"5px"},modelValue:e.value,"onUpdate:modelValue":o=>e.value=o},null,8,["modelValue","onUpdate:modelValue"])):e.tag==="el-select"?(n(),u(U,{key:2,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,placeholder:"请选择"},{default:i(()=>[(n(!0),g(y,null,x(e.options,o=>(n(),u(C,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.tag==="el-radio-group"?(n(),u(m,{key:3,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,class:"radio-group"},{default:i(()=>[(n(!0),g(y,null,x(e.options,o=>(n(),u(d,{label:o.label,key:o.label},{default:i(()=>[v(Q(o.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type==="date"?(n(),g(y,{key:4},[e.config.type.indexOf("range")>=0?(n(),u(w,{key:0,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,type:e.config.type,"unlink-panels":"","start-placeholder":"开始时间","end-placeholder":"结束时间","default-time":e.config.defaultTime,format:e.config.format,"value-format":e.config.valueFormat,"picker-options":s.datePickerOptions,style:{"margin-left":"5px"}},null,8,["modelValue","onUpdate:modelValue","type","default-time","format","value-format","picker-options"])):(n(),u(w,{key:1,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,type:e.config.type,format:e.config.format,"value-format":e.config.valueFormat,"picker-options":s.datePickerOptions,style:{"margin-left":"5px"}},null,8,["modelValue","onUpdate:modelValue","type","format","value-format","picker-options"]))],64)):e.type==="number"?(n(),u(F,{key:5,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,"controls-position":"right",style:{width:"120px","margin-left":"5px"}},null,8,["modelValue","onUpdate:modelValue"])):e.type==="bool"?(n(),u(r,{key:6,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o},null,8,["modelValue","onUpdate:modelValue"])):(n(),u($,{key:7,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024),c(b,{span:1},{default:i(()=>[c(E,{onClick:o=>D(k,e),style:{"margin-left":"5px"}},{default:i(()=>[c(O)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))]),_:1},8,["data","props"]))])}}});const Oe=X(oe,[["__scopeId","data-v-5e1e784d"]]);export{Oe as default};
