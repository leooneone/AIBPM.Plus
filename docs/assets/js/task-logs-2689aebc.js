var C=Object.defineProperty;var P=(n,o,t)=>o in n?C(n,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[o]=t;var y=(n,o,t)=>(P(n,typeof o!="symbol"?o+"":o,t),t);import{J as S,K as T,_ as V}from"./index-c27e5712.js";import{d as M}from"./dayjs-97457aaf.js";import{k as w,l as Y,m as r,$ as j,o as d,D as m,y as p,a as u,p as i,G as _,M as B}from"./@vue-8306d5ee.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-97a12f88.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./@intlify-869ec77a.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";class H extends S{constructor(){super(...arguments);y(this,"getPage",(t,g={})=>this.request({path:"/api/admin/task-log/get-page",method:"POST",body:t,secure:!0,type:T.Json,format:"json",...g}))}}const N={class:"my-drawer-body-padding"},U={class:"my-flex my-flex-end",style:{"margin-top":"20px"}},J={style:{flex:"auto",padding:"20px !important"}},q=w({name:"admin/taskLog"}),A=w({...q,props:{title:{type:String,default:""}},setup(n,{expose:o}){const t=Y({showDialog:!1,loading:!1,taskLogFormTitle:"",total:0,pageInput:{currentPage:1,pageSize:20,filter:{taskId:null}},taskLogListData:[]}),g=(e,s,a)=>M(a).format("YYYY-MM-DD HH:mm:ss"),c=async()=>{var s,a;t.loading=!0;const e=await new H().getPage(t.pageInput).catch(()=>{t.loading=!1});t.taskLogListData=((s=e==null?void 0:e.data)==null?void 0:s.list)??[],t.total=((a=e==null?void 0:e.data)==null?void 0:a.total)??0,t.loading=!1},k=e=>{t.pageInput.pageSize=e,c()},h=e=>{t.pageInput.currentPage=e,c()},b=e=>{t.pageInput.filter&&(t.pageInput.filter.taskId=e.id),c(),t.showDialog=!0},x=()=>{t.showDialog=!1};return o({open:b}),(e,s)=>{const a=r("el-table-column"),f=r("el-tag"),v=r("el-table"),D=r("el-pagination"),I=r("el-button"),z=r("el-drawer"),L=j("loading");return d(),m(z,{modelValue:t.showDialog,"onUpdate:modelValue":s[2]||(s[2]=l=>t.showDialog=l),title:n.title,direction:"ltr",size:"780"},{footer:p(()=>[u("div",J,[i(I,{onClick:x,size:"default"},{default:p(()=>[_("取 消")]),_:1})])]),default:p(()=>[u("div",N,[B((d(),m(v,{data:t.taskLogListData,"row-key":"id",style:{width:"100%"}},{default:p(()=>[i(a,{prop:"round",label:"当前次数",width:"80"}),i(a,{prop:"success",label:"状态",width:"80"},{default:p(({row:l})=>[l.success?(d(),m(f,{key:1,type:"success","disable-transitions":""},{default:p(()=>[_("成功")]),_:1})):(d(),m(f,{key:0,type:"danger","disable-transitions":""},{default:p(()=>[_("失败")]),_:1}))]),_:1}),i(a,{prop:"elapsedMilliseconds",label:"耗时(ms)",width:"100"}),i(a,{prop:"exception",label:"异常","min-width":"180"}),i(a,{prop:"createTime",label:"创建时间",formatter:g,width:"160"}),i(a,{prop:"Remark",label:"备注","min-width":"180"})]),_:1},8,["data"])),[[L,t.loading]]),u("div",U,[i(D,{currentPage:t.pageInput.currentPage,"onUpdate:currentPage":s[0]||(s[0]=l=>t.pageInput.currentPage=l),"page-size":t.pageInput.pageSize,"onUpdate:pageSize":s[1]||(s[1]=l=>t.pageInput.pageSize=l),total:t.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:k,onCurrentChange:h,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])])]),_:1},8,["modelValue","title"])}}});const ft=V(A,[["__scopeId","data-v-4237ef33"]]);export{ft as default};
