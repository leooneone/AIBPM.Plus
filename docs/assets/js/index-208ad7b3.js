import{_ as l}from"./ai-form-3baf0d65.js";import{C as o}from"./Captcha-3d192d5e.js";import{k as p,R as d,e as f,l as h,o as _,D as q,q as R,u as I}from"./@vue-8306d5ee.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./index-0ce5277f.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const v=p({name:"my-captcha"}),W=p({...v,emits:["ok"],setup(k,{expose:c,emit:n}){const m=d(()=>l(()=>import("./slide-captcha-0d70226b.js"),["assets/js/slide-captcha-0d70226b.js","assets/js/@vue-8306d5ee.js","assets/js/index-0ce5277f.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/ai-form-3baf0d65.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css","assets/css/slide-captcha-e17c2137.css"])),a=f(),t=h({requestId:"",failTip:"",successTip:""}),i=async()=>{a.value.startRequestGenerate();const e=await new o().generate({captchaId:t.requestId}).catch(()=>{a.value.endRequestGenerate(null,null)});e!=null&&e.success&&e.data&&(t.requestId=e.data.id||"",a.value.endRequestGenerate(e.data.backgroundImage,e.data.sliderImage))},u=async e=>{a.value.startRequestVerify();const s=await new o().check(e,{captchaId:t.requestId}).catch(()=>{t.failTip="服务异常，请稍后重试",a.value.endRequestVerify(!1)});if(s!=null&&s.success&&s.data){let r=s.data.result===0;t.failTip=s.data.result==1?"验证未通过，拖动滑块将悬浮图像正确合并":"验证超时, 请重新操作",t.successTip="验证通过",a.value.endRequestVerify(r),r?n("ok",{captchaId:t.requestId,track:e}):setTimeout(()=>{i()},1e3)}};return c({refresh:()=>{var e;(e=a.value)==null||e.handleRefresh()}}),(e,s)=>(_(),q(I(m),R({ref_key:"slideCaptchaRef",ref:a,"fail-tip":t.failTip,"success-tip":t.successTip,width:"100%",height:"auto",onRefresh:i,onFinish:u},e.$attrs),null,16,["fail-tip","success-tip"]))}});export{W as default};
