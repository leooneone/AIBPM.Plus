var Y=Object.defineProperty;var A=(m,p,e)=>p in m?Y(m,p,{enumerable:!0,configurable:!0,writable:!0,value:e}):m[p]=e;var d=(m,p,e)=>(A(m,typeof p!="symbol"?p+"":p,e),e);import{_ as G}from"./ai-form-3baf0d65.js";import{c as F,d as D}from"./data-contracts-a56545c2.js";import{H as Q,C as h}from"./http-client-5da26c39.js";import{d as K}from"./dayjs-97457aaf.js";import{k as M,h as W,e as X,l as Z,i as ee,m as s,$ as P,o as b,c as te,a as S,p as t,y as l,G as f,M as T,D as z,v,u as g,x as oe,R as ae}from"./@vue-8306d5ee.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./@intlify-869ec77a.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./axios-21b846bc.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./index-0ce5277f.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";class E extends Q{constructor(){super(...arguments);d(this,"get",(e,a={})=>this.request({path:"/api/bpm/instance/get",method:"GET",query:e,secure:!0,format:"json",...a}));d(this,"page",(e,a={})=>this.request({path:"/api/bpm/instance/page",method:"POST",body:e,secure:!0,type:h.Json,format:"json",...a}));d(this,"start",(e,a={})=>this.request({path:"/api/bpm/instance/start",method:"POST",query:e,secure:!0,format:"json",...a}));d(this,"add",(e,a={})=>this.request({path:"/api/bpm/instance/add",method:"POST",body:e,secure:!0,type:h.Json,...a}));d(this,"update",(e,a={})=>this.request({path:"/api/bpm/instance/update",method:"PUT",body:e,secure:!0,type:h.Json,...a}));d(this,"delete",(e,a={})=>this.request({path:"/api/bpm/instance/delete",method:"DELETE",query:e,secure:!0,...a}));d(this,"softDelete",(e,a={})=>this.request({path:"/api/bpm/instance/soft-delete",method:"DELETE",query:e,secure:!0,...a}));d(this,"batchSoftDelete",(e,a={})=>this.request({path:"/api/bpm/instance/batch-soft-delete",method:"PUT",body:e,secure:!0,type:h.Json,...a}))}}const ne={style:{padding:"0px 0px 8px 8px"}},ie={class:"my-flex my-flex-end",style:{"margin-top":"20px"}},le=M({name:"bpm/instance"}),$e=M({...le,props:{state:String,isHandled:Boolean},setup(m){const p=m,e=ae(()=>G(()=>import("./myForm-02060158.js"),["assets/js/myForm-02060158.js","assets/js/ai-form-3baf0d65.js","assets/js/@vue-8306d5ee.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/data-contracts-a56545c2.js","assets/js/http-client-5da26c39.js","assets/js/axios-21b846bc.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/index-0ce5277f.js","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css","assets/js/WorkflowTemplate-52609167.js","assets/css/myForm-024936cc.css"])),{proxy:a}=W(),{dic_bpm_group:q}=a.$dict("bpm-group"),w=X(),o=Z({loading:!1,filterModel:{name:""},total:0,pageInput:{currentPage:1,pageSize:20,filter:{}},listData:[]});ee(()=>{_()});const V=(i,r,u)=>K(u).format("YYYY-MM-DD HH:mm:ss"),_=async()=>{var r,u;o.loading=!0,p.state&&(o.pageInput.filter.state=p.state),p.isHandled&&(o.pageInput.filter.isHandled=!0);const i=await new E().page(o.pageInput);o.listData=((r=i==null?void 0:i.data)==null?void 0:r.list)??[],o.total=((u=i.data)==null?void 0:u.total)??0,o.loading=!1},H=i=>{a.$modal.confirmDelete(`确定要取消【${i.name}】流程?`).then(async()=>{await new E().delete({id:i.id},{loading:!0,showSuccessMessage:!0}),_()}).catch(()=>{})},$=i=>{o.pageInput.pageSize=i,_()},B=i=>{o.pageInput.currentPage=i,_()},C=i=>{w.value.open({type:3,instanceId:i.id,templateId:i.workflowTemplateId})};return(i,r)=>{const u=s("el-input"),x=s("el-form-item"),y=s("el-button"),j=s("el-form"),I=s("el-card"),c=s("el-table-column"),N=s("el-link"),R=s("el-tag"),U=s("el-table"),J=s("el-pagination"),L=P("auth"),O=P("loading");return b(),te("section",null,[S("div",ne,[t(I,{shadow:"never","body-style":{paddingBottom:"0"},style:{"margin-top":"8px"}},{default:l(()=>[t(j,{model:o.filterModel,inline:!0},{default:l(()=>[t(x,{prop:"name"},{default:l(()=>[t(u,{modelValue:o.filterModel.name,"onUpdate:modelValue":r[0]||(r[0]=n=>o.filterModel.name=n),placeholder:"流程名称"},null,8,["modelValue"])]),_:1}),t(x,null,{default:l(()=>[t(y,{type:"primary",icon:"ele-Search",onClick:_},{default:l(()=>[f(" 查询 ")]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),t(I,{shadow:"never",style:{"margin-top":"8px"}},{default:l(()=>[T((b(),z(U,{data:o.listData,"row-key":"id",style:{width:"100%"},border:""},{default:l(()=>[t(c,{type:"index",width:"60",label:"序号"}),t(c,{prop:"referenceNo",label:"单号","show-overflow-tooltip":"",width:"120"}),t(c,{prop:"name",label:"流程名称","min-width":"120","show-overflow-tooltip":""},{default:l(({row:n})=>[t(N,{onClick:k=>C(n)},{default:l(()=>[f(v(n.name),1)]),_:2},1032,["onClick"])]),_:1}),t(c,{prop:"groupId",label:"流程分组","show-overflow-tooltip":"",width:"120"},{default:l(({row:n})=>[f(v(g(q)[n.groupId]),1)]),_:1}),t(c,{prop:"state",label:"流程状态",width:"100"},{default:l(({row:n})=>[t(R,{"disable-transitions":"",type:g(F)[n.state&127].toLowerCase()},{default:l(()=>[f(v(g(D)[n.state]),1)]),_:2},1032,["type"])]),_:1}),t(c,{prop:"initiator",label:"创建人","show-overflow-tooltip":"",width:"120"}),t(c,{prop:"createdTime",label:"创建时间",formatter:V,width:"180"}),t(c,{label:"操作",width:"180",fixed:"right","header-align":"center",align:"center"},{default:l(({row:n})=>[t(y,{icon:"ele-CaretRight",size:"small",text:"",type:"primary",onClick:k=>C(n)},{default:l(()=>[f("进入")]),_:2},1032,["onClick"]),g(D)[n.state]==="运行中"?T((b(),z(y,{key:0,icon:"ele-Promotion",size:"small",text:"",type:"primary",onClick:k=>H(n)},{default:l(()=>[f("撤回")]),_:2},1032,["onClick"])),[[L,"api:bpm:template:cancel"]]):oe("",!0)]),_:1})]),_:1},8,["data"])),[[O,o.loading]]),S("div",ie,[t(J,{currentPage:o.pageInput.currentPage,"onUpdate:currentPage":r[1]||(r[1]=n=>o.pageInput.currentPage=n),"page-size":o.pageInput.pageSize,"onUpdate:pageSize":r[2]||(r[2]=n=>o.pageInput.pageSize=n),total:o.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:$,onCurrentChange:B,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])]),_:1})]),t(g(e),{ref_key:"formRef",ref:w},null,512)])}}});export{$e as default};
