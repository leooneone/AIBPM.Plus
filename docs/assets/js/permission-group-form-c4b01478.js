import{_ as R}from"./ai-form-3baf0d65.js";import{P as g}from"./Permission-0387a68f.js";import{V as G}from"./View-add566c5.js";import{e as M,P as N}from"./index-1c0db287.js";import{k as h,h as z,e as B,l as E,ah as O,m as u,o as $,c as q,p as l,y as t,a as f,G as w,u as d,v as y,R as F}from"./@vue-8306d5ee.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const j={class:"my-flex my-flex-between"},H=["title"],J={class:"dialog-footer"},K=h({name:"admin/permission/permission-group-form"}),ve=h({...K,props:{title:{type:String,default:""},permissionTreeData:{type:Array,default:()=>[]}},setup(V,{expose:v}){const D=F(()=>R(()=>import("./index-6f6637f0.js"),["assets/js/index-6f6637f0.js","assets/js/getStyleSheets-a93480e6.js","assets/js/@element-plus-8ef115d9.js","assets/js/@vue-8306d5ee.js","assets/js/index-1c0db287.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/ai-form-3baf0d65.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css","assets/css/index-0e23bf1c.css"])),{proxy:c}=z(),b=B(),a=E({showDialog:!1,sureLoading:!1,form:{enabled:!0,opened:!0},viewTreeData:[]}),{form:n}=O(a),I=async()=>{const r=await new G().getList();r!=null&&r.success&&r.data&&r.data.length>0?a.viewTreeData=N(r.data):a.viewTreeData=[]},U=async(r={})=>{if(c.$modal.loading(),await I(),r.id>0){const e=await new g().getGroup({id:r.id}).catch(()=>{c.$modal.closeLoading()});if(e!=null&&e.success){let i=e.data;i.parentId=i.parentId&&i.parentId>0?i.parentId:void 0,a.form=i}}else a.form={enabled:!0,opened:!0,icon:"ele-Memo"};c.$modal.closeLoading(),a.showDialog=!0},k=(r,e)=>{var i,s;return r?((i=e.label)==null?void 0:i.indexOf(r))!==-1||((s=e.path)==null?void 0:s.indexOf(r))!==-1:!0},L=()=>{a.showDialog=!1},T=()=>{b.value.validate(async r=>{if(!r)return;a.sureLoading=!0;let e={};a.form.parentId=a.form.parentId&&a.form.parentId>0?a.form.parentId:void 0,a.form.id!=null&&a.form.id>0?e=await new g().updateGroup(a.form,{showSuccessMessage:!0}).catch(()=>{a.sureLoading=!1}):e=await new g().addGroup(a.form,{showSuccessMessage:!0}).catch(()=>{a.sureLoading=!1}),a.sureLoading=!1,e!=null&&e.success&&(M.emit("refreshPermission"),a.showDialog=!1)})};return v({open:U}),(r,e)=>{const i=u("el-tree-select"),s=u("el-form-item"),m=u("el-col"),p=u("el-input"),C=u("el-input-number"),_=u("el-switch"),P=u("el-row"),S=u("el-form"),x=u("el-button"),A=u("el-dialog");return $(),q("div",null,[l(A,{modelValue:a.showDialog,"onUpdate:modelValue":e[11]||(e[11]=o=>a.showDialog=o),"destroy-on-close":"",title:V.title,draggable:"","close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px"},{footer:t(()=>[f("span",J,[l(x,{onClick:L,size:"default"},{default:t(()=>[w("取 消")]),_:1}),l(x,{type:"primary",onClick:T,size:"default",loading:a.sureLoading},{default:t(()=>[w("确 定")]),_:1},8,["loading"])])]),default:t(()=>[l(S,{model:d(n),ref_key:"formRef",ref:b,size:"default","label-width":"80px"},{default:t(()=>[l(P,{gutter:35},{default:t(()=>[l(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(s,{label:"上级分组"},{default:t(()=>[l(i,{modelValue:d(n).parentId,"onUpdate:modelValue":e[0]||(e[0]=o=>d(n).parentId=o),data:V.permissionTreeData,"node-key":"id","check-strictly":"","default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",class:"w100"},null,8,["modelValue","data"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(s,{label:"视图"},{default:t(()=>[l(i,{modelValue:d(n).viewId,"onUpdate:modelValue":e[1]||(e[1]=o=>d(n).viewId=o),data:a.viewTreeData,"node-key":"id",props:{label:"path"},"default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",filterable:"","filter-node-method":k,class:"w100"},{default:t(({data:o})=>[f("span",j,[f("span",null,y(o.label),1),f("span",{class:"my-line-1 my-ml-12",title:o.path},y(o.path),9,H)])]),_:1},8,["modelValue","data"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(s,{label:"名称",prop:"label",rules:[{required:!0,message:"请输入名称",trigger:["blur","change"]}]},{default:t(()=>[l(p,{modelValue:d(n).label,"onUpdate:modelValue":e[2]||(e[2]=o=>d(n).label=o),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(s,{label:"路由地址",prop:"path",rules:[{required:!0,message:"请输入路由地址",trigger:["blur","change"]}]},{default:t(()=>[l(p,{modelValue:d(n).path,"onUpdate:modelValue":e[3]||(e[3]=o=>d(n).path=o),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(s,{label:"路由命名"},{default:t(()=>[l(p,{modelValue:d(n).name,"onUpdate:modelValue":e[4]||(e[4]=o=>d(n).name=o),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(s,{label:"重定向"},{default:t(()=>[l(p,{modelValue:d(n).redirect,"onUpdate:modelValue":e[5]||(e[5]=o=>d(n).redirect=o),clearable:"",placeholder:"重定向地址"},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(s,{label:"图标",prop:"icon"},{default:t(()=>[l(d(D),{modelValue:d(n).icon,"onUpdate:modelValue":e[6]||(e[6]=o=>d(n).icon=o),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(s,{label:"排序"},{default:t(()=>[l(C,{modelValue:d(n).sort,"onUpdate:modelValue":e[7]||(e[7]=o=>d(n).sort=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(s,{label:"启用"},{default:t(()=>[l(_,{modelValue:d(n).enabled,"onUpdate:modelValue":e[8]||(e[8]=o=>d(n).enabled=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(s,{label:"展开"},{default:t(()=>[l(_,{modelValue:d(n).opened,"onUpdate:modelValue":e[9]||(e[9]=o=>d(n).opened=o)},null,8,["modelValue"])]),_:1})]),_:1}),l(m,{xs:24,sm:12,md:12,lg:12,xl:12},{default:t(()=>[l(s,{label:"隐藏"},{default:t(()=>[l(_,{modelValue:d(n).hidden,"onUpdate:modelValue":e[10]||(e[10]=o=>d(n).hidden=o)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{ve as default};
