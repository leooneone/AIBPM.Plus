import{_ as P}from"./ai-form-3baf0d65.js";import{k as D,h as j,e as q,l as H,i as J,E as W,m as i,$ as v,o as r,c as I,p as a,y as o,Y as X,am as Z,G as c,M as _,D as p,v as ee,u as f,F as te,x as ne,a as ae,R as T}from"./@vue-8306d5ee.js";import{T as w}from"./Tenant-cd8a3a03.js";import{e as b}from"./index-0ce5277f.js";import{a as V}from"./authFunction-ba07a050.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const oe={class:"my-layout"},le={class:"my-flex my-flex-end",style:{"margin-top":"20px"}},ie=D({name:"admin/tenant"}),$e=D({...ie,setup(re){const S=T(()=>P(()=>import("./tenant-form-252b3d10.js"),["assets/js/tenant-form-252b3d10.js","assets/js/Tenant-cd8a3a03.js","assets/js/index-0ce5277f.js","assets/js/@vue-8306d5ee.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/ai-form-3baf0d65.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css","assets/js/Pkg-e8a6aa3b.js","assets/js/test-fb6d7fa5.js"])),z=T(()=>P(()=>import("./index-e3a260ae.js"),["assets/js/index-e3a260ae.js","assets/js/@vue-8306d5ee.js","assets/js/index-0ce5277f.js","assets/js/pinia-e84f6aa2.js","assets/js/vue-demi-71ba0ef2.js","assets/js/ai-form-3baf0d65.js","assets/js/element-plus-e21f9b5a.js","assets/js/lodash-es-f559e892.js","assets/js/@vueuse-245b213e.js","assets/js/@element-plus-8ef115d9.js","assets/js/@popperjs-c75af06c.js","assets/js/@ctrl-f8748455.js","assets/js/dayjs-97457aaf.js","assets/js/@intlify-869ec77a.js","assets/js/async-validator-dee29e8b.js","assets/js/memoize-one-297ddbcb.js","assets/js/escape-html-e77024c3.js","assets/js/normalize-wheel-es-ed76fb12.js","assets/js/@floating-ui-c2863df3.js","assets/css/ai-form-078e22e0.css","assets/js/vue-router-c9c3da21.js","assets/js/vue-i18n-86a71ef1.js","assets/js/vue-27cbb85a.js","assets/js/js-cookie-edb2da2a.js","assets/js/nprogress-b96aa312.js","assets/css/nprogress-8b89e2e0.css","assets/js/axios-21b846bc.js","assets/js/mitt-f7ef348c.js","assets/js/vue-grid-layout-9f938aef.js","assets/css/index-6baff94b.css"])),{proxy:k}=j(),g=q(),t=H({loading:!1,tenantFormTitle:"",total:0,filter:{name:""},pageInput:{currentPage:1,pageSize:20},tenantListData:[]});J(()=>{d(),b.off("refreshTenant"),b.on("refreshTenant",async()=>{d()})}),W(()=>{b.off("refreshTenant")});const d=async()=>{var l,s;t.loading=!0,t.pageInput.filter=t.filter;const e=await new w().getPage(t.pageInput).catch(()=>{t.loading=!1});t.tenantListData=((l=e==null?void 0:e.data)==null?void 0:l.list)??[],t.total=((s=e==null?void 0:e.data)==null?void 0:s.total)??0,t.loading=!1},F=()=>{t.tenantFormTitle="新增租户",g.value.open()},M=e=>{t.tenantFormTitle="编辑租户",g.value.open(e)},N=e=>{k.$modal.confirmDelete(`确定要删除【${e.name}】?`).then(async()=>{await new w().delete({id:e.id},{loading:!0,showSuccessMessage:!0}),d()}).catch(()=>{})},$=e=>new Promise((l,s)=>{k.$modal.confirm(`确定要${e.enabled?"禁用":"启用"}【${e.name}】?`).then(async()=>{e.loading=!0;const u=await new w().setEnable({tenantId:e.id,enabled:!e.enabled},{showSuccessMessage:!0}).catch(()=>{s(new Error("Error"))}).finally(()=>{e.loading=!1});u&&u.success?l(!0):s(new Error("Cancel"))}).catch(()=>{s(new Error("Cancel"))})}),B=e=>{t.pageInput.pageSize=e,d()},A=e=>{t.pageInput.currentPage=e,d()};return(e,l)=>{const s=i("el-input"),u=i("el-form-item"),h=i("el-button"),L=i("el-form"),C=i("el-card"),m=i("el-table-column"),R=i("el-switch"),x=i("el-tag"),U=i("el-dropdown-item"),K=i("el-dropdown-menu"),O=i("el-table"),G=i("el-pagination"),E=v("auth"),Q=v("auths"),Y=v("loading");return r(),I("div",oe,[a(C,{class:"mt8",shadow:"never","body-style":{paddingBottom:"0"}},{default:o(()=>[a(L,{inline:!0,onSubmit:l[1]||(l[1]=X(()=>{},["stop","prevent"]))},{default:o(()=>[a(u,{label:"企业名称"},{default:o(()=>[a(s,{modelValue:t.filter.name,"onUpdate:modelValue":l[0]||(l[0]=n=>t.filter.name=n),placeholder:"企业名称",onKeyup:Z(d,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),a(u,null,{default:o(()=>[a(h,{type:"primary",icon:"ele-Search",onClick:d},{default:o(()=>[c(" 查询 ")]),_:1}),_((r(),p(h,{type:"primary",icon:"ele-Plus",onClick:F},{default:o(()=>[c(" 新增 ")]),_:1})),[[E,"api:admin:tenant:add"]])]),_:1})]),_:1})]),_:1}),a(C,{class:"my-fill mt8",shadow:"never"},{default:o(()=>[_((r(),p(O,{data:t.tenantListData,"row-key":"id",height:"'100%'",style:{width:"100%",height:"100%"}},{default:o(()=>[a(m,{prop:"name",label:"企业名称","min-width":"120","show-overflow-tooltip":""}),a(m,{prop:"code",label:"企业编码",width:"120","show-overflow-tooltip":""}),a(m,{prop:"pkgNames",label:"套餐",width:"140","show-overflow-tooltip":""},{default:o(({row:n})=>[c(ee(n.pkgNames?n.pkgNames.join(","):""),1)]),_:1}),a(m,{prop:"realName",label:"姓名",width:"120","show-overflow-tooltip":""}),a(m,{prop:"phone",label:"手机号",width:"120","show-overflow-tooltip":""}),a(m,{label:"状态",width:"80",align:"center",fixed:"right"},{default:o(({row:n})=>[f(V)("api:admin:tenant:set-enable")?(r(),p(R,{key:0,modelValue:n.enabled,"onUpdate:modelValue":y=>n.enabled=y,loading:n.loading,"active-value":!0,"inactive-value":!1,"inline-prompt":"","active-text":"启用","inactive-text":"禁用","before-change":()=>$(n)},null,8,["modelValue","onUpdate:modelValue","loading","before-change"])):(r(),I(te,{key:1},[n.enabled?(r(),p(x,{key:0,type:"success"},{default:o(()=>[c("启用")]),_:1})):(r(),p(x,{key:1,type:"danger"},{default:o(()=>[c("禁用")]),_:1}))],64))]),_:1}),a(m,{label:"操作",width:"140","header-align":"center",align:"center",fixed:"right"},{default:o(({row:n})=>[_((r(),p(h,{icon:"ele-EditPen",size:"small",text:"",type:"primary",onClick:y=>M(n)},{default:o(()=>[c("编辑")]),_:2},1032,["onClick"])),[[E,"api:admin:tenant:update"]]),_((r(),p(f(z),null,{dropdown:o(()=>[a(K,null,{default:o(()=>[f(V)("api:admin:tenant:delete")?(r(),p(U,{key:0,onClick:y=>N(n)},{default:o(()=>[c("删除租户")]),_:2},1032,["onClick"])):ne("",!0)]),_:2},1024)]),_:2},1024)),[[Q,["api:admin:tenant:delete"]]])]),_:1})]),_:1},8,["data"])),[[Y,t.loading]]),ae("div",le,[a(G,{currentPage:t.pageInput.currentPage,"onUpdate:currentPage":l[2]||(l[2]=n=>t.pageInput.currentPage=n),"page-size":t.pageInput.pageSize,"onUpdate:pageSize":l[3]||(l[3]=n=>t.pageInput.pageSize=n),total:t.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:B,onCurrentChange:A,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])]),_:1}),a(f(S),{ref_key:"tenantFormRef",ref:g,title:t.tenantFormTitle},null,8,["title"])])}}});export{$e as default};
