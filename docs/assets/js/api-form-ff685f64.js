import{A as c}from"./Api-be052949.js";import{e as A}from"./index-aa73a18b.js";import{k as x,e as M,l as S,ah as z,m as n,o as B,c as N,p as e,y as o,a as R,G as V,u as d}from"./@vue-8306d5ee.js";import"./pinia-e84f6aa2.js";import"./vue-demi-71ba0ef2.js";import"./ai-form-7f0c78d7.js";import"./element-plus-e21f9b5a.js";import"./lodash-es-f559e892.js";import"./@vueuse-245b213e.js";import"./@element-plus-8ef115d9.js";import"./@popperjs-c75af06c.js";import"./@ctrl-f8748455.js";import"./dayjs-97457aaf.js";import"./@intlify-869ec77a.js";import"./async-validator-dee29e8b.js";import"./memoize-one-297ddbcb.js";import"./escape-html-e77024c3.js";import"./normalize-wheel-es-ed76fb12.js";import"./@floating-ui-c2863df3.js";import"./vue-router-c9c3da21.js";import"./vue-i18n-86a71ef1.js";import"./vue-27cbb85a.js";import"./js-cookie-edb2da2a.js";import"./nprogress-b96aa312.js";import"./axios-21b846bc.js";import"./mitt-f7ef348c.js";import"./vue-grid-layout-9f938aef.js";const T={class:"dialog-footer"},q=x({name:"admin/api/form"}),ue=x({...q,props:{title:{type:String,default:""},apiTreeData:{type:Array,default:()=>[]}},setup(_,{expose:w}){const g=M(),t=S({showDialog:!1,sureLoading:!1,form:{enabled:!0}}),{form:a}=z(t),h=async(p={})=>{if(p.id>0){const l=await new c().get({id:p.id},{loading:!0});if(l!=null&&l.success){let s=l.data;s.parentId=s.parentId&&s.parentId>0?s.parentId:void 0,t.form=s}}else t.form={enabled:!0};t.showDialog=!0},y=()=>{t.showDialog=!1},I=()=>{g.value.validate(async p=>{if(!p)return;t.sureLoading=!0;let l={};t.form.parentId=t.form.parentId&&t.form.parentId>0?t.form.parentId:void 0,t.form.id!=null&&t.form.id>0?l=await new c().update(t.form,{showSuccessMessage:!0}).catch(()=>{t.sureLoading=!1}):l=await new c().add(t.form,{showSuccessMessage:!0}).catch(()=>{t.sureLoading=!1}),t.sureLoading=!1,l!=null&&l.success&&(A.emit("refreshApi"),t.showDialog=!1)})};return w({open:h}),(p,l)=>{const s=n("el-tree-select"),m=n("el-form-item"),i=n("el-col"),f=n("el-input"),u=n("el-radio-button"),k=n("el-radio-group"),D=n("el-input-number"),v=n("el-switch"),U=n("el-row"),C=n("el-form"),b=n("el-button"),L=n("el-dialog");return B(),N("div",null,[e(L,{modelValue:t.showDialog,"onUpdate:modelValue":l[7]||(l[7]=r=>t.showDialog=r),"destroy-on-close":"",title:_.title,draggable:"","close-on-click-modal":!1,"close-on-press-escape":!1,width:"600px"},{footer:o(()=>[R("span",T,[e(b,{onClick:y,size:"default"},{default:o(()=>[V("取 消")]),_:1}),e(b,{type:"primary",onClick:I,size:"default",loading:t.sureLoading},{default:o(()=>[V("确 定")]),_:1},8,["loading"])])]),default:o(()=>[e(C,{model:d(a),ref_key:"formRef",ref:g,size:"default","label-width":"80px"},{default:o(()=>[e(U,{gutter:35},{default:o(()=>[e(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(m,{label:"上级接口"},{default:o(()=>[e(s,{modelValue:d(a).parentId,"onUpdate:modelValue":l[0]||(l[0]=r=>d(a).parentId=r),data:_.apiTreeData,"node-key":"id","check-strictly":"","default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",class:"w100"},null,8,["modelValue","data"])]),_:1})]),_:1}),e(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(m,{label:"接口名称",prop:"label",rules:[{required:!0,message:"请输入接口名称",trigger:["blur","change"]}]},{default:o(()=>[e(f,{modelValue:d(a).label,"onUpdate:modelValue":l[1]||(l[1]=r=>d(a).label=r),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(m,{label:"接口地址",prop:"path",rules:[{required:!0,message:"请输入接口地址",trigger:["blur","change"]}]},{default:o(()=>[e(f,{modelValue:d(a).path,"onUpdate:modelValue":l[2]||(l[2]=r=>d(a).path=r),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(m,{label:"接口方法",prop:"httpMethods"},{default:o(()=>[e(k,{modelValue:d(a).httpMethods,"onUpdate:modelValue":l[3]||(l[3]=r=>d(a).httpMethods=r)},{default:o(()=>[e(u,{label:"get"}),e(u,{label:"put"}),e(u,{label:"post"}),e(u,{label:"patch"}),e(u,{label:"delete"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:24,md:24,lg:24,xl:24},{default:o(()=>[e(m,{label:"接口描述",prop:"description"},{default:o(()=>[e(f,{modelValue:d(a).description,"onUpdate:modelValue":l[4]||(l[4]=r=>d(a).description=r),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12},{default:o(()=>[e(m,{label:"排序"},{default:o(()=>[e(D,{modelValue:d(a).sort,"onUpdate:modelValue":l[5]||(l[5]=r=>d(a).sort=r)},null,8,["modelValue"])]),_:1})]),_:1}),e(i,{xs:24,sm:12,md:12,lg:12,xl:12},{default:o(()=>[e(m,{label:"启用"},{default:o(()=>[e(v,{modelValue:d(a).enabled,"onUpdate:modelValue":l[6]||(l[6]=r=>d(a).enabled=r)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{ue as default};
