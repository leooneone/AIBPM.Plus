import{O as v}from"./Org.95a10495.js";import{l as x}from"./tree.d5b28a07.js";import{b as C}from"./index.6c5a2d2c.js";import{d as c,r as D,O as w,w as K,o as V,H as N,S as n,a4 as B,e as s,l as O,m as i,z as d,p as b,f as F,D as M,u as E}from"./vue.df334614.js";const R=c({name:"admin/org/menu"}),P=c({...R,props:{modelValue:{default:()=>[]},selectFirstNode:{type:Boolean,default:!1}},emits:["node-click","update:modelValue"],setup(u,{expose:f,emit:r}){const p=u,o=D(),t=w({loading:!1,filterText:"",orgTreeData:[],lastKey:0});K(()=>t.filterText,e=>{var a;(a=o.value)==null||a.filter(e)}),V(()=>{_()});const m=(e,a)=>{var l;return e?((l=a.name)==null?void 0:l.indexOf(e))!==-1:!0},g=e=>{var a;t.lastKey===e.id?(t.lastKey=0,(a=o.value)==null||a.setCurrentKey(void 0),r("node-click",null)):(t.lastKey=e.id,r("node-click",e))},h=()=>{var e;r("update:modelValue",(e=o.value)==null?void 0:e.getCheckedKeys())},_=async()=>{t.loading=!0;const e=await new v().getList();t.loading=!1,e!=null&&e.success&&e.data&&e.data.length>0?(t.orgTreeData=x(e.data),p.selectFirstNode&&N(()=>{var l;const a=t.orgTreeData[0];(l=o.value)==null||l.setCurrentKey(a.id),r("node-click",a)})):t.orgTreeData=[]};return f({orgMenuRef:o}),(e,a)=>{const l=n("el-input"),k=n("el-card"),y=B("loading");return s(),O(k,{shadow:"never",style:{"margin-top":"8px"}},{header:i(()=>[d(l,{modelValue:t.filterText,"onUpdate:modelValue":a[0]||(a[0]=T=>t.filterText=T),placeholder:"筛选部门",clearable:""},null,8,["modelValue"])]),default:i(()=>[b((s(),F("div",null,[d(E(C),M({ref_key:"orgMenuRef",ref:o,data:t.orgTreeData,"node-key":"id",props:{children:"children",label:"name"},"filter-node-method":m,"highlight-current":"","check-strictly":"","default-expand-all":"","render-after-expand":"","expand-on-click-node":!1},e.$attrs,{onNodeClick:g,onCheckChange:h}),null,16,["data"])])),[[y,t.loading]])]),_:1})}}});export{P as _};
