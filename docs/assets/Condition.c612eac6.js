import{d as L,O as j,w as z,S as p,e as n,f as g,z as c,l as u,m as r,t as H,F as v,B as T,p as J,v as K,x as y,y as Q}from"./vue.72f2672d.js";import{_ as X}from"./_plugin-vue_export-helper.c27b6911.js";const Z={key:0},ee=y("并且"),le=y("或者"),oe=y("分组"),te=y("条件"),ne=L({__name:"Condition",props:{fields:{type:Array,default(){return[]}},conditions:{type:Array,default(){return[]}},data:{type:Object,default(){return{isDefault:!0}}}},setup(W,{expose:A}){const f=W,a={equal:{label:"等于",value:"Equal"},notEqual:{label:"不等于",value:"NotEqual"},contains:{label:"包含",value:"Contains"},notContains:{label:"不包含",value:"NotContains"},startsWith:{label:"开始以",value:"StartsWith"},notStartsWith:{label:"开始不是以",value:"NotStartsWith"},endsWith:{label:"结束以",value:"EndsWith"},notEndsWith:{label:"结束不是以",value:"NotEndsWith"},lessThan:{label:"小于",value:"LessThan"},lessThanOrEqual:{label:"小于等于",value:"LessThanOrEqual"},greaterThan:{label:"大于",value:"GreaterThan"},greaterThanOrEqual:{label:"大于等于",value:"GreaterThanOrEqual"},dateRange:{label:"时间段",value:"dateRange"},any:{label:"在列表",value:"Any"},notAny:{label:"不在列表",value:"NotAny"}},N={default:[a.equal],string:[a.equal,a.notEqual,a.contains,a.notContains,a.startsWith,a.notStartsWith,a.endsWith,a.notEndsWith],date:[a.equal,a.notEqual,a.lessThan,a.lessThanOrEqual,a.greaterThan,a.greaterThanOrEqual,a.dateRange],number:[a.equal,a.notEqual,a.lessThan,a.lessThanOrEqual,a.greaterThan,a.greaterThanOrEqual],bool:[a.equal]};let x={field:"",label:""};if(f.fields&&f.fields.length>0){const t=f.fields.find(l=>l.default===!0);t?x=t:x=f.fields[0]}const s=j({loading:!1,key:1,dataTree:{},defaultProps:{label:"",children:"filters"},operatorGroups:N,firstField:x,datePickerOptions:{disabledDate(t){return t.getTime()>Date.now()}}});z(()=>f.data,t=>{s.dataTree=t.root===void 0?{root:!0,logic:"And",filters:[]}:t},{deep:!0,immediate:!0});const Y=()=>{if(f.data.isDefault||!s.dataTree.filters||s.dataTree.filters.length==0)return{isDefault:!0};var t={...s.dataTree,isDefault:f.data.isDefault};return t},h=t=>{const l=s.operatorGroups[t||""];return l&&l.length>0?l:s.operatorGroups.default},S=(t,l)=>{if(f.fields===void 0)return;const i=f.fields.find(m=>m.vModel===t);l.value="",l.label=i.label,l.tag=i.tag,l.type=i.dataType?i.dataType:"",l.options=i.options;const _=h(l.type);let d="";if(i.operator&&(d=_.findIndex(V=>V.value===i.operator)>=0?i.operator:""),d||(d=_[0].value),l.operator=d,l.config={...i.config},l.type==="date"){let m="date";l.operator==="dateRange"&&(m=m+"range"),l.config.type=l.config.type?l.config.type:m,l.config.type.indexOf("range")>=0&&(l.operator="dateRange"),l.config.format=l.config.format?l.config.format:"YYYY-MM-DD",l.config.valueFormat=l.config.valueFormat?l.config.valueFormat:"YYYY-MM-DD",l.config.defaultTime=l.config.defaultTime?l.config.defaultTime:["00:00:00","00:00:00"]}},G=(t,l)=>{l.type==="date"&&(s.key++,t==="dateRange"?(l.value="",l.config.type=l.config.type+"range"):l.config.type.indexOf("range")>=0&&(l.value="",l.config.type=l.config.type.replace(/range$/,"")))},I=t=>{const l={logic:"And"};t.filters||(t.filters=[]),t.filters.push(l)},M=t=>{const l=h(t.type)[0],i={field:s.firstField.field,label:s.firstField.label,operator:l.value,config:{...s.firstField.config},value:s.firstField.value};t.filters||(t.filters=[]);const _=t.filters.findIndex(d=>d.logic&&!d.field);_>=0?t.filters.splice(_,0,i):t.filters.push(i)},q=(t,l)=>{const i=t.parent,_=i.data.filters||i.data,d=_.findIndex(m=>m===l);_.splice(d,1)};return A({onConfirm:Y}),(t,l)=>{const i=p("el-switch"),_=p("el-empty"),d=p("el-radio"),m=p("el-radio-group"),V=p("el-button"),D=p("ele-Delete"),E=p("el-icon"),C=p("el-option"),U=p("el-select"),b=p("el-col"),R=p("ai-ou-select"),F=p("el-input-number"),w=p("el-date-picker"),P=p("el-input"),$=p("el-row"),B=p("el-tree");return n(),g("section",null,[c(i,{modelValue:f.data.isDefault,"onUpdate:modelValue":l[0]||(l[0]=k=>f.data.isDefault=k),"active-text":"默认/其他条件","inactive-text":"指定条件"},null,8,["modelValue"]),f.data.isDefault?(n(),u(_,{key:0,description:"无需配置条件"})):(n(),u(B,{key:1,data:[s.dataTree],props:s.defaultProps,"expand-on-click-node":!1,"default-expand-all":!0,indent:16,class:"my-search-filter"},{default:r(({node:k,data:e})=>[e.logic&&!e.field?(n(),g("span",Z,[c(m,{modelValue:e.logic,"onUpdate:modelValue":o=>e.logic=o},{default:r(()=>[c(d,{label:"And"},{default:r(()=>[ee]),_:1}),c(d,{label:"Or"},{default:r(()=>[le]),_:1})]),_:2},1032,["modelValue","onUpdate:modelValue"]),c(V,{type:"text",icon:"el-icon-plus",onClick:o=>I(e)},{default:r(()=>[oe]),_:2},1032,["onClick"]),c(V,{type:"text",icon:"el-icon-plus",onClick:o=>M(e)},{default:r(()=>[te]),_:2},1032,["onClick"]),e.root?H("",!0):(n(),u(E,{key:0,onClick:o=>q(k,e),style:{"margin-left":"8px"}},{default:r(()=>[c(D)]),_:2},1032,["onClick"]))])):(n(),u($,{key:1,gutter:5},{default:r(()=>[c(b,{span:8},{default:r(()=>[c(U,{modelValue:e.field,"onUpdate:modelValue":o=>e.field=o,loading:s.loading,filterable:"",onChange:o=>S(o,e)},{default:r(()=>[(n(!0),g(v,null,T(f.conditions,(o,O)=>(n(),u(C,{key:O,label:o.label,value:o.vModel},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","loading","onChange"])]),_:2},1024),J(c(b,{span:4},{default:r(()=>[c(U,{modelValue:e.operator,"onUpdate:modelValue":o=>e.operator=o,onChange:o=>G(o,e)},{default:r(()=>[(n(!0),g(v,null,T(h(e.type),(o,O)=>(n(),u(C,{key:O,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1536),[[K,h(e.type).length>1]]),c(b,{span:11},{default:r(()=>[e.tag==="ai-ou-select"?(n(),u(R,{key:0,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,tabList:["user"]},null,8,["modelValue","onUpdate:modelValue"])):e.tag==="fc-amount"||e.tag==="el-input-number"?(n(),u(F,{key:1,style:{"margin-left":"5px"},modelValue:e.value,"onUpdate:modelValue":o=>e.value=o},null,8,["modelValue","onUpdate:modelValue"])):e.tag==="el-select"?(n(),u(U,{key:2,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,placeholder:"请选择"},{default:r(()=>[(n(!0),g(v,null,T(e.options,o=>(n(),u(C,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.tag==="el-radio-group"?(n(),u(m,{key:3,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,class:"radio-group"},{default:r(()=>[(n(!0),g(v,null,T(e.options,o=>(n(),u(d,{label:o.label,key:o.label},{default:r(()=>[y(Q(o.label),1)]),_:2},1032,["label"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])):e.type==="date"?(n(),g(v,{key:4},[e.config.type.indexOf("range")>=0?(n(),u(w,{key:0,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,type:e.config.type,"unlink-panels":"","start-placeholder":"开始时间","end-placeholder":"结束时间","default-time":e.config.defaultTime,format:e.config.format,"value-format":e.config.valueFormat,"picker-options":s.datePickerOptions,style:{"margin-left":"5px"}},null,8,["modelValue","onUpdate:modelValue","type","default-time","format","value-format","picker-options"])):(n(),u(w,{key:1,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,type:e.config.type,format:e.config.format,"value-format":e.config.valueFormat,"picker-options":s.datePickerOptions,style:{"margin-left":"5px"}},null,8,["modelValue","onUpdate:modelValue","type","format","value-format","picker-options"]))],64)):e.type==="number"?(n(),u(F,{key:5,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,"controls-position":"right",style:{width:"120px","margin-left":"5px"}},null,8,["modelValue","onUpdate:modelValue"])):e.type==="bool"?(n(),u(i,{key:6,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o},null,8,["modelValue","onUpdate:modelValue"])):(n(),u(P,{key:7,modelValue:e.value,"onUpdate:modelValue":o=>e.value=o},null,8,["modelValue","onUpdate:modelValue"]))]),_:2},1024),c(b,{span:1},{default:r(()=>[c(E,{onClick:o=>q(k,e),style:{"margin-left":"5px"}},{default:r(()=>[c(D)]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024))]),_:1},8,["data","props"]))])}}});const re=X(ne,[["__scopeId","data-v-b9ef3d13"]]);export{re as default};
