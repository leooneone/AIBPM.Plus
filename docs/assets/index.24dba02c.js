import{_ as w}from"./preload-helper.101896b7.js";import{d as $,a6 as b,r as P,O as oe,o as ie,P as ne,S as s,a4 as x,e as r,f as F,z as n,m as o,G as se,E as ae,p as C,l as p,u as m,t as c,x as l,y as d,L as re}from"./vue.72f2672d.js";import{P as V}from"./Permission.84a23a17.js";import{t as le,l as M}from"./tree.d5b28a07.js";import{e as A}from"./mitt.7f99bbc0.js";import{a as u}from"./authFunction.99f183da.js";import{c as h}from"./cloneDeep.d5c086cd.js";import"./http-client.3dda918f.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";import"./userInfo.6e870420.js";import"./arrayOperation.b573dead.js";import"./_Uint8Array.e4cf923d.js";import"./_initCloneObject.7b8933bc.js";const pe={style:{padding:"0px 0px 8px 8px"}},me=l(" 查询 "),de=l("新增"),_e=l("新增分组"),ce=l("新增菜单"),ue=l("新增权限点"),fe={key:0},ye={key:1},he=l("启用"),ve=l("禁用"),ke=l("编辑"),ge=l("删除"),Te=$({name:"admin/permission"}),Se=$({...Te,setup(De){const I=b(()=>w(()=>import("./permission-group-form.39a0d8f3.js"),["assets/permission-group-form.39a0d8f3.js","assets/preload-helper.101896b7.js","assets/Permission.84a23a17.js","assets/http-client.3dda918f.js","assets/index.57385bce.js","assets/index.0c380c40.js","assets/vue.72f2672d.js","assets/index.41e0794f.js","assets/storage.6b2e7cd0.js","assets/View.fdf4950c.js","assets/tree.d5b28a07.js","assets/mitt.7f99bbc0.js"])),K=b(()=>w(()=>import("./permission-menu-form.3213d5a8.js"),["assets/permission-menu-form.3213d5a8.js","assets/preload-helper.101896b7.js","assets/Permission.84a23a17.js","assets/http-client.3dda918f.js","assets/index.57385bce.js","assets/index.0c380c40.js","assets/vue.72f2672d.js","assets/index.41e0794f.js","assets/storage.6b2e7cd0.js","assets/View.fdf4950c.js","assets/tree.d5b28a07.js","assets/mitt.7f99bbc0.js","assets/_plugin-vue_export-helper.c27b6911.js","assets/permission-menu-form.3016a983.css"])),L=b(()=>w(()=>import("./permission-dot-form.1799f6ff.js"),["assets/permission-dot-form.1799f6ff.js","assets/Permission.84a23a17.js","assets/http-client.3dda918f.js","assets/index.57385bce.js","assets/index.0c380c40.js","assets/vue.72f2672d.js","assets/index.41e0794f.js","assets/storage.6b2e7cd0.js","assets/Api.790b3ba4.js","assets/tree.d5b28a07.js","assets/mitt.7f99bbc0.js","assets/_baseIndexOf.e907b547.js","assets/_plugin-vue_export-helper.c27b6911.js","assets/permission-dot-form.525b5526.css"])),{proxy:S}=re(),v=P(),k=P(),g=P(),t=oe({loading:!1,permissionFormTitle:"",filterModel:{name:""},permissionTreeData:[],formPermissionGroupTreeData:[],formPermissionMenuTreeData:[],expandRowKeys:[]});ie(async()=>{await f(),t.expandRowKeys=le(h(t.permissionTreeData)).filter(i=>i.opened===!0).map(i=>i.id+""),A.on("refreshPermission",async()=>{f()})}),ne(()=>{A.off("refreshPermission")});const f=async()=>{t.loading=!0;const i=await new V().getList();i.data&&i.data.length>0?(t.permissionTreeData=M(h(i.data)),t.formPermissionGroupTreeData=M(h(i.data).filter(a=>a.type===1)),t.formPermissionMenuTreeData=M(h(i.data).filter(a=>a.type===1||a.type===2))):(t.permissionTreeData=[],t.formPermissionGroupTreeData=[],t.formPermissionMenuTreeData=[]),t.loading=!1},T=i=>{switch(i){case 1:t.permissionFormTitle="新增分组",v.value.open();break;case 2:t.permissionFormTitle="新增菜单",k.value.open();break;case 3:t.permissionFormTitle="新增权限点",g.value.open();break}},B=i=>{switch(i.type){case 1:t.permissionFormTitle="编辑分组",v.value.open(i);break;case 2:t.permissionFormTitle="编辑菜单",k.value.open(i);break;case 3:t.permissionFormTitle="编辑权限点",g.value.open(i);break}},O=i=>{S.$modal.confirmDelete(`确定要删除${i.type===1?"分组":i.type===2?"菜单":i.type===3?"权限点":""}【${i.label}】?`).then(async()=>{await new V().delete({id:i.id},{loading:!0}),f()}).catch(()=>{})};return(i,a)=>{const z=s("el-input"),R=s("el-form-item"),y=s("el-button"),N=s("ele-ArrowDown"),U=s("el-icon"),D=s("el-dropdown-item"),Q=s("el-dropdown-menu"),j=s("el-dropdown"),q=s("el-form"),E=s("el-card"),H=s("SvgIcon"),_=s("el-table-column"),G=s("el-tag"),J=s("el-table"),W=s("el-col"),X=s("el-row"),Y=x("auths"),Z=x("auth"),ee=x("loading");return r(),F("div",pe,[n(X,{gutter:8,style:{width:"100%"}},{default:o(()=>[n(W,{span:24,xs:24},{default:o(()=>[n(E,{shadow:"never","body-style":{paddingBottom:"0"},style:{"margin-top":"8px"}},{default:o(()=>[n(q,{model:t.filterModel,inline:!0,onSubmit:a[4]||(a[4]=se(()=>{},["stop","prevent"]))},{default:o(()=>[n(R,{label:"权限名称",prop:"name"},{default:o(()=>[n(z,{modelValue:t.filterModel.name,"onUpdate:modelValue":a[0]||(a[0]=e=>t.filterModel.name=e),placeholder:"权限名称",onKeyup:ae(f,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),n(R,null,{default:o(()=>[n(y,{type:"primary",icon:"ele-Search",onClick:f},{default:o(()=>[me]),_:1}),C((r(),p(j,{style:{"margin-left":"12px"}},{dropdown:o(()=>[n(Q,null,{default:o(()=>[m(u)("api:admin:permission:addgroup")?(r(),p(D,{key:0,onClick:a[1]||(a[1]=e=>T(1))},{default:o(()=>[_e]),_:1})):c("",!0),m(u)("api:admin:permission:addmenu")?(r(),p(D,{key:1,onClick:a[2]||(a[2]=e=>T(2))},{default:o(()=>[ce]),_:1})):c("",!0),m(u)("api:admin:permission:adddot")?(r(),p(D,{key:2,onClick:a[3]||(a[3]=e=>T(3))},{default:o(()=>[ue]),_:1})):c("",!0)]),_:1})]),default:o(()=>[n(y,{type:"primary"},{default:o(()=>[de,n(U,{class:"el-icon--right"},{default:o(()=>[n(N)]),_:1})]),_:1})]),_:1})),[[Y,["api:admin:permission:addgroup","api:admin:permission:addmenu","api:admin:permission:adddot"]]])]),_:1})]),_:1},8,["model"])]),_:1}),n(E,{shadow:"never",style:{"margin-top":"8px"}},{default:o(()=>[C((r(),p(J,{data:t.permissionTreeData,style:{width:"100%"},"row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"},"expand-row-keys":t.expandRowKeys},{default:o(()=>[n(_,{prop:"label",label:"权限名称",width:"240","show-overflow-tooltip":""},{default:o(({row:e})=>[n(H,{name:e.icon},null,8,["name"]),l(" "+d(e.label),1)]),_:1}),n(_,{prop:"type",label:"类型",width:"80","show-overflow-tooltip":""},{default:o(({row:e})=>[l(d(e.type===1?"分组":e.type===2?"菜单":e.type===3?"权限点":""),1)]),_:1}),n(_,{prop:"path",label:"权限地址","min-width":"240","show-overflow-tooltip":""},{default:o(({row:e})=>[e.type===1||e.type===2?(r(),F("div",fe,d(e.path?"路由地址："+e.path:"")+" "+d(e.viewPath?"视图地址："+e.viewPath:"")+" "+d(e.redirect?"重定向地址："+e.redirect:"")+" "+d(e.link?"链接地址："+e.link:""),1)):c("",!0),e.type===3?(r(),F("div",ye,"接口地址："+d(e.apiPaths),1)):c("",!0)]),_:1}),n(_,{prop:"sort",label:"排序",width:"80",align:"center","show-overflow-tooltip":""}),n(_,{label:"状态",width:"80",align:"center","show-overflow-tooltip":""},{default:o(({row:e})=>[e.enabled?(r(),p(G,{key:0,type:"success"},{default:o(()=>[he]),_:1})):(r(),p(G,{key:1,type:"danger"},{default:o(()=>[ve]),_:1}))]),_:1}),n(_,{label:"操作",width:"160",fixed:"right","header-align":"center",align:"center"},{default:o(({row:e})=>[e.type===1&&m(u)("api:admin:permission:updategroup")||e.type===2&&m(u)("api:admin:permission:updatemenu")||e.type===3&&m(u)("api:admin:permission:updatedot")?(r(),p(y,{key:0,icon:"ele-EditPen",size:"small",text:"",type:"primary",onClick:te=>B(e)},{default:o(()=>[ke]),_:2},1032,["onClick"])):c("",!0),C((r(),p(y,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:te=>O(e)},{default:o(()=>[ge]),_:2},1032,["onClick"])),[[Z,"api:admin:permission:delete"]])]),_:1})]),_:1},8,["data","expand-row-keys"])),[[ee,t.loading]])]),_:1})]),_:1})]),_:1}),n(m(I),{ref_key:"permissionGroupFormRef",ref:v,title:t.permissionFormTitle,"permission-tree-data":t.formPermissionGroupTreeData},null,8,["title","permission-tree-data"]),n(m(K),{ref_key:"permissionMenuFormRef",ref:k,title:t.permissionFormTitle,"permission-tree-data":t.formPermissionGroupTreeData},null,8,["title","permission-tree-data"]),n(m(L),{ref_key:"permissionDotFormRef",ref:g,title:t.permissionFormTitle,"permission-tree-data":t.formPermissionMenuTreeData},null,8,["title","permission-tree-data"])])}}});export{Se as default};
