import R from"./user-select.1d26c97c.js";import{_ as A}from"./org-select.vue_vue_type_script_setup_true_lang.a6f7774d.js";import{_ as J}from"./role-select.vue_vue_type_script_setup_true_lang.bfe2b7cf.js";import{d as $,O as z,r as g,w as N,S as i,e as m,f as L,t as p,z as r,m as s,h,g as j,l as c,F as E,x as O}from"./vue.72f2672d.js";import{_ as F}from"./_plugin-vue_export-helper.c27b6911.js";import"./User.3d01ec91.js";import"./http-client.3dda918f.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";import"./org-menu.vue_vue_type_script_setup_true_lang.cd7d218a.js";import"./Org.1b60eeb8.js";import"./tree.d5b28a07.js";import"./index.79e12c01.js";import"./index.1e09e151.js";import"./index.eead254e.js";import"./_Uint8Array.e4cf923d.js";import"./index.55c7ed79.js";import"./_initCloneObject.7b8933bc.js";import"./focus-trap.c8a23a9c.js";import"./Role.9719caad.js";const M={class:"dialog-footer"},I=O("取 消"),q=O("确 定"),G=$({__name:"index",props:{tabs:{type:Array,default:()=>["user"]},modelValue:{type:Object,default:()=>({user:[],role:[],org:[]})},nullTips:{type:String,default:"暂无选择"},title:{type:String,default:""},multiple:{type:Boolean,default:!1},sureLoading:{type:Boolean,default:!1}},emits:["sure","update:modelValue"],setup(f,{expose:S,emit:_}){const n=f,e=z({showDialog:!1,selected:{},tags:[],showTags:[]}),y=g(),V=g(),b=g(),T=()=>{e.showDialog=!0},w=()=>{e.showDialog=!1},k=()=>{e.showDialog=!1},v=()=>e.tags.map(t=>t.name).join(","),C=()=>{const t=e.tags;_("update:modelValue",JSON.parse(JSON.stringify(e.selected))),e.showTags=e.tags,_("sure",n.multiple?t:t.length>0?t[0]:null),w()},U=t=>{if(t.tagName==="user")b.value.removeTag(t);else if(t.tagName==="org"){const o=e.selected.org.indexOf(t);e.selected.org.splice(o,1),y.value.orgMenuRef.setCheckedNodes(e.selected.org)}else if(t.tagName==="role")try{const o=e.selected.role.indexOf(t);e.selected.role.splice(o,1),V.value.orgMenuRef.setCheckedNodes(e.selected.role)}catch{console.log("ex")}},x=t=>{let o=[];if(Array.isArray(t))o=t;else for(var d in t){var u=t[d];Array.isArray(u)&&u.forEach(a=>{a.tagName=d,d==="user"?a.tagType="success":d==="org"?a.tagType="warning":d==="role"&&(a.tagType="danger"),o.push(a)})}return o};return N(()=>n.modelValue,()=>{e.selected=JSON.parse(JSON.stringify(n.modelValue)),e.tags=x(e.selected),e.showTags=e.tags},{deep:!0,immediate:!0}),N(()=>e.selected,t=>{e.tags=x(t)},{deep:!0,immediate:!0}),S({open:T,close:w,getLabels:v}),(t,o)=>{const d=i("el-button"),u=i("ai-tag-input"),a=i("el-tab-pane"),B=i("el-tabs"),D=i("el-dialog");return m(),L(E,null,[p("",!0),r(u,{modelValue:e.showTags,"onUpdate:modelValue":o[0]||(o[0]=l=>e.showTags=l),nullTips:n.nullTips,onClick:T},{default:s(()=>[h(t.$slots,"default",{},void 0,!0)]),_:3},8,["modelValue","nullTips"]),r(D,{modelValue:e.showDialog,"onUpdate:modelValue":o[5]||(o[5]=l=>e.showDialog=l),"destroy-on-close":"",title:n.title,"append-to-body":"",draggable:"",width:"780px"},{title:s(()=>[h(t.$slots,"default",{},void 0,!0)]),footer:s(()=>[j("span",M,[r(d,{onClick:k,size:"default"},{default:s(()=>[I]),_:1}),r(d,{type:"primary",onClick:C,size:"default",loading:f.sureLoading},{default:s(()=>[q]),_:1},8,["loading"])])]),default:s(()=>[r(B,{type:"border-card"},{default:s(()=>[n.tabs.includes("user")?(m(),c(a,{key:0,label:"用户"},{default:s(()=>[r(R,{modelValue:e.selected.user,"onUpdate:modelValue":o[1]||(o[1]=l=>e.selected.user=l),ref_key:"myUser",ref:b,title:"添加员工",multiple:""},null,8,["modelValue"])]),_:1})):p("",!0),n.tabs.includes("org")?(m(),c(a,{key:1,label:"组织"},{default:s(()=>[r(A,{ref_key:"myOrg",ref:y,modelValue:e.selected.org,"onUpdate:modelValue":o[2]||(o[2]=l=>e.selected.org=l)},null,8,["modelValue"])]),_:1})):p("",!0),n.tabs.includes("role")?(m(),c(a,{key:2,label:"角色"},{default:s(()=>[r(J,{modelValue:e.selected.role,"onUpdate:modelValue":o[3]||(o[3]=l=>e.selected.role=l),ref_key:"myRole",ref:V},null,8,["modelValue"])]),_:1})):p("",!0)]),_:1}),r(u,{modelValue:e.tags,"onUpdate:modelValue":o[4]||(o[4]=l=>e.tags=l),onRemoveTag:U,closable:!0,collapseTags:100},null,8,["modelValue"])]),_:3},8,["modelValue","title"])],64)}}});const ce=F(G,[["__scopeId","data-v-d2b318a7"]]);export{ce as default};
