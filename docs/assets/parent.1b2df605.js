import{_ as I}from"./preload-helper.101896b7.js";import{d as V,a6 as P,a7 as x,av as B,a8 as h,O as E,c as f,a9 as S,H as _,o as D,P as O,w as M,S as U,e as l,f as q,z as i,m as c,T as d,u as t,l as w,p as R,v as y,q as z,aw as H}from"./vue.72f2672d.js";import{u as b}from"./keepAliveNames.8ff91aac.js";import{u as j}from"./themeConfig.598b93cc.js";import{S as F}from"./storage.6b2e7cd0.js";import{e as K}from"./mitt.7f99bbc0.js";const G={class:"layout-parent"},J=V({name:"layoutParentView"}),se=V({...J,setup(Q){const g=P(()=>I(()=>import("./iframes.c2c4c37f.js"),["assets/iframes.c2c4c37f.js","assets/vue.72f2672d.js"])),o=x(),A=B(),T=b(),L=j(),{keepAliveNames:n,cachedViews:p}=h(T),{themeConfig:m}=h(L),e=E({refreshRouterViewKey:"",iframeRefreshKey:"",keepAliveNameList:[],iframeList:[]}),u=f(()=>m.value.animation),k=f(()=>m.value.isTagsview?p.value:e.keepAliveNameList),v=f(()=>o.meta.isIframe),N=async()=>{A.getRoutes().forEach(s=>{s.meta.isIframe&&(s.meta.isIframeOpen=!1,s.meta.loading=!0,e.iframeList.push({...s}))})};return S(()=>{e.keepAliveNameList=n.value,K.on("onTagsViewRefreshRouterView",s=>{e.keepAliveNameList=n.value.filter(a=>o.name!==a),e.refreshRouterViewKey="",e.iframeRefreshKey="",_(()=>{e.refreshRouterViewKey=s,e.iframeRefreshKey=s,e.keepAliveNameList=n.value})})}),D(()=>{N(),_(()=>{setTimeout(()=>{if(m.value.isCacheTagsView){let s=F.get("tagsViewList")||[];p.value=s.filter(a=>{var r;return(r=a.meta)==null?void 0:r.isKeepAlive}).map(a=>a.name)}},0)})}),O(()=>{K.off("onTagsViewRefreshRouterView",()=>{})}),M(()=>o.fullPath,()=>{e.refreshRouterViewKey=decodeURI(o.fullPath)},{immediate:!0}),(s,a)=>{const r=U("router-view");return l(),q("div",G,[i(r,null,{default:c(({Component:C})=>[i(d,{name:t(u),mode:"out-in"},{default:c(()=>[(l(),w(H,{include:t(k)},[R((l(),w(z(C),{key:e.refreshRouterViewKey,class:"w100"})),[[y,!t(v)]])],1032,["include"]))]),_:2},1032,["name"])]),_:1}),i(d,{name:t(u),mode:"out-in"},{default:c(()=>[R(i(t(g),{class:"w100",refreshKey:e.iframeRefreshKey,name:t(u),list:e.iframeList},null,8,["refreshKey","name","list"]),[[y,t(v)]])]),_:1},8,["name"])])}}});export{se as default};
