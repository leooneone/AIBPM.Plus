import T from"./Permission.90a9a010.js";import P from"./Operation.06714c7c.js";import S from"./Participant.5fcaadee.js";import O from"./Condition.20a743ea.js";import z from"./Circulate.f1f7e9a6.js";import{C as j}from"./index.e64efb6f.js";import{S as t,e as n,l as d,C as J,m as o,x as p,y,p as E,v as B,g as N,z as i,t as r,f as h}from"./vue.df334614.js";import{_ as U}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.a7cafc43.js";import"./user-select.fdd46137.js";import"./User.905b1cf5.js";import"./http-client.28a8ff7a.js";import"./index.de963593.js";import"./index.390778f0.js";import"./index.4621962e.js";import"./storage.6b2e7cd0.js";import"./org-menu.vue_vue_type_script_setup_true_lang.6d7eb461.js";import"./Org.791a1909.js";import"./tree.d5b28a07.js";import"./index.6c5a2d2c.js";import"./index.7cba2d6b.js";import"./index.f4a20413.js";import"./_Uint8Array.2a02cf9e.js";import"./_initCloneObject.115dee92.js";import"./focus-trap.ccecd842.js";import"./org-select.vue_vue_type_script_setup_true_lang.1cbb9c1d.js";import"./role-select.vue_vue_type_script_setup_true_lang.c64fbe36.js";import"./Role.d52d88a4.js";const M={inject:["titleChange"],directives:{ClickOutside:j},components:{Permission:T,Participant:S,Condition:O,Circulate:z,Operation:P},props:{fields:{type:Array,default:()=>{}},node:{type:Object,default:()=>{}}},data(){return{titleInputVisible:!1,curNode:{},isDrawer:!1,workflowTypes:[{label:"开始",value:"start"},{label:"结束",value:"end"},{label:"条件",value:"condition"},{label:"传阅",value:"circulate"},{label:"审批",value:"approver"}]}},watch:{isDrawer(s){s?this.$nextTick(()=>{this.curNode=JSON.parse(JSON.stringify(this.node))}):(console.log("---------------curnode={}---------"),this.curNode={})}},methods:{showTitleInput(){this.titleInputVisible=!0,this.$nextTick(()=>this.$refs.titleInput.focus())},onTitleChange(){this.titleChange(this.curNode.title),this.titleInputVisible=!1},onConfirm(){var s,l,u,m;this.node.approve=(s=this.$refs.approvePanel)==null?void 0:s.onConfirm(),this.node.permission=(l=this.$refs.permissionPanel)==null?void 0:l.onConfirm(),this.node.condition=(u=this.$refs.conditionPanel)==null?void 0:u.onConfirm(),this.node.circulate=(m=this.$refs.circulatePanel)==null?void 0:m.onConfirm(),console.log("  panel confirmed"),this.close()},close(){this.isDrawer=!1},open(){this.isDrawer=!0,this.$nextTick(()=>{})}}},q={key:0},G={key:1},H={key:2},K={style:{flex:"auto"}},L=p("取消"),Q=p("确定");function R(s,l,u,m,e,c){const b=t("ele-Edit"),F=t("el-icon"),v=t("el-input"),k=t("condition"),a=t("el-tab-pane"),w=t("participant"),A=t("permission"),D=t("circulate");t("el-option"),t("el-select");const V=t("el-tabs"),C=t("el-button"),x=t("el-drawer");return u.node?(n(),d(x,{key:0,title:"$t('message.layout.configTitle')",modelValue:e.isDrawer,"onUpdate:modelValue":l[3]||(l[3]=f=>e.isDrawer=f),direction:"rtl",isModal:"false","destroy-on-close":"",size:"600px"},J({footer:o(()=>[N("div",K,[i(C,{onClick:c.close},{default:o(()=>[L]),_:1},8,["onClick"]),i(C,{type:"primary",onClick:c.onConfirm},{default:o(()=>[Q]),_:1},8,["onClick"])])]),default:o(()=>[i(V,{type:"border-card",style:{height:"calc(100vh - 95px)"}},{default:o(()=>[e.curNode.type==="condition"?(n(),d(a,{key:0,label:"条件"},{default:o(()=>[i(k,{ref:"conditionPanel",fields:u.fields,data:e.curNode.condition},null,8,["fields","data"])]),_:1})):r("",!0),["approve","deal"].includes(e.curNode.type)?(n(),d(a,{key:1,label:"参与人设置"},{default:o(()=>[i(w,{ref:"approvePanel",fields:u.fields,data:e.curNode.approve},null,8,["fields","data"])]),_:1})):r("",!0),["approve","start","deal"].includes(e.curNode.type)?(n(),d(a,{key:2,label:"表单权限"},{default:o(()=>[i(A,{ref:"permissionPanel",fields:u.fields,data:e.curNode.permission},null,8,["fields","data"])]),_:1})):r("",!0),e.curNode.type==="circulate"?(n(),d(a,{key:3,label:"传阅"},{default:o(()=>[i(D,{ref:"circulatePanel",fields:u.fields,data:e.curNode.circulate},null,8,["fields","data"])]),_:1})):r("",!0),i(a,{label:"说明"},{default:o(()=>[e.curNode.type==="start"?(n(),h("div",q," 每个流程只允许一个启动节点 ")):e.curNode.type==="end"?(n(),h("div",G," 每个流程只允许一个结束节点； 结束节点可以有一条或者多条入向连接，但没有出向连接。 ")):(n(),h("div",H," 这里是节点说明 "))]),_:1}),r("",!0)]),_:1})]),_:2},[e.curNode&&e.curNode.type=="start"?{name:"header",fn:o(({close:f,titleId:g,titleClass:I})=>[p(y(e.curNode.title),1)])}:{name:"header",fn:o(({close:f,titleId:g,titleClass:I})=>[E(N("span",{onClick:l[0]||(l[0]=(..._)=>c.showTitleInput&&c.showTitleInput(..._)),style:{cursor:"pointer"}},[p(y(e.curNode.title)+" ",1),i(F,{style:{"font-size":"1.5em"}},{default:o(()=>[i(b)]),_:1})],512),[[B,!e.titleInputVisible]]),E(i(v,{ref:"titleInput",size:"mini",modelValue:e.curNode.title,"onUpdate:modelValue":l[1]||(l[1]=_=>e.curNode.title=_),placeholder:"请输入节点标签",onBlur:c.onTitleChange},null,8,["modelValue","onBlur"]),[[B,e.titleInputVisible]])])}]),1032,["title","modelValue"])):r("",!0)}const Fe=U(M,[["render",R]]);export{Fe as default};
