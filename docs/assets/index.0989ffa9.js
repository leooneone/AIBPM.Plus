import{_ as z}from"./preload-helper.101896b7.js";import{d as C,a6 as K,r as L,O as R,o as I,P as N,S as l,a4 as v,e as r,f as U,z as t,m as e,G,E as Q,p as m,l as d,x as i,y as j,u as x,L as q}from"./vue.72f2672d.js";import{O as b}from"./Org.a1ce8cb9.js";import{l as H}from"./tree.d5b28a07.js";import{e as k}from"./mitt.7f99bbc0.js";import"./http-client.193f2c5b.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";const J={style:{padding:"0px 0px 8px 8px"}},W=i(" 查询 "),X=i(" 新增 "),Y=i("启用"),Z=i("禁用"),ee=i("编辑"),te=i("删除"),oe=C({name:"admin/org"}),ue=C({...oe,setup(le){const T=K(()=>z(()=>import("./org-form.59415f42.js"),["assets/org-form.59415f42.js","assets/preload-helper.101896b7.js","assets/Org.a1ce8cb9.js","assets/http-client.193f2c5b.js","assets/index.57385bce.js","assets/index.0c380c40.js","assets/vue.72f2672d.js","assets/index.41e0794f.js","assets/storage.6b2e7cd0.js","assets/mitt.7f99bbc0.js"])),{proxy:g}=q(),{dic_ou_type:D}=g.$dict("ou-type"),u=L(),o=R({loading:!1,orgFormTitle:"",filterModel:{name:""},orgTreeData:[]});I(()=>{p(),k.on("refreshOrg",()=>{p()})}),N(()=>{k.off("refreshOrg")});const p=async()=>{o.loading=!0;const n=await new b().getList();n.data&&n.data.length>0?o.orgTreeData=H(n.data):o.orgTreeData=[],o.loading=!1},F=()=>{o.orgFormTitle="新增组织",u.value.open()},O=n=>{o.orgFormTitle="编辑组织",u.value.open(n)},E=n=>{g.$modal.confirmDelete(`确定要删除组织【${n.name}】?`).then(async()=>{await new b().delete({id:n.id},{loading:!0}),p()}).catch(()=>{})};return(n,c)=>{const M=l("el-input"),h=l("el-form-item"),_=l("el-button"),V=l("el-form"),y=l("el-card"),s=l("el-table-column"),w=l("el-tag"),P=l("el-table"),$=l("el-col"),A=l("el-row"),f=v("auth"),B=v("loading");return r(),U("div",J,[t(A,{gutter:8,style:{width:"100%"}},{default:e(()=>[t($,{span:24,xs:24},{default:e(()=>[t(y,{shadow:"never","body-style":{paddingBottom:"0"},style:{"margin-top":"8px"}},{default:e(()=>[t(V,{model:o.filterModel,inline:!0,onSubmit:c[1]||(c[1]=G(()=>{},["stop","prevent"]))},{default:e(()=>[t(h,{label:"组织名称",prop:"name"},{default:e(()=>[t(M,{modelValue:o.filterModel.name,"onUpdate:modelValue":c[0]||(c[0]=a=>o.filterModel.name=a),placeholder:"组织名称",onKeyup:Q(p,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),t(h,null,{default:e(()=>[t(_,{type:"primary",icon:"ele-Search",onClick:p},{default:e(()=>[W]),_:1}),m((r(),d(_,{type:"primary",icon:"ele-Plus",onClick:F},{default:e(()=>[X]),_:1})),[[f,"api:admin:org:add"]])]),_:1})]),_:1},8,["model"])]),_:1}),t(y,{shadow:"never",style:{"margin-top":"8px"}},{default:e(()=>[m((r(),d(P,{data:o.orgTreeData,style:{width:"100%"},"row-key":"id","default-expand-all":"","tree-props":{children:"children",hasChildren:"hasChildren"}},{default:e(()=>[t(s,{prop:"name",label:"组织名称","min-width":"120","show-overflow-tooltip":""}),t(s,{prop:"code",label:"组织编码","min-width":"120","show-overflow-tooltip":""}),t(s,{prop:"value",label:"组织类型","min-width":"80","show-overflow-tooltip":""},{default:e(({row:a})=>[i(j(x(D)[a.type]),1)]),_:1}),t(s,{prop:"sort",label:"排序",width:"80",align:"center","show-overflow-tooltip":""}),t(s,{label:"状态",width:"80",align:"center","show-overflow-tooltip":""},{default:e(({row:a})=>[a.enabled?(r(),d(w,{key:0,type:"success"},{default:e(()=>[Y]),_:1})):(r(),d(w,{key:1,type:"danger"},{default:e(()=>[Z]),_:1}))]),_:1}),t(s,{label:"操作",width:"160",fixed:"right","header-align":"center",align:"center"},{default:e(({row:a})=>[m((r(),d(_,{icon:"ele-EditPen",size:"small",text:"",type:"primary",onClick:S=>O(a)},{default:e(()=>[ee]),_:2},1032,["onClick"])),[[f,"api:admin:org:update"]]),m((r(),d(_,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:S=>E(a)},{default:e(()=>[te]),_:2},1032,["onClick"])),[[f,"api:admin:org:delete"]])]),_:1})]),_:1},8,["data"])),[[B,o.loading]])]),_:1})]),_:1})]),_:1}),t(x(T),{ref_key:"orgFormRef",ref:u,title:o.orgFormTitle,"org-tree-data":o.orgTreeData},null,8,["title","org-tree-data"])])}}});export{ue as default};
