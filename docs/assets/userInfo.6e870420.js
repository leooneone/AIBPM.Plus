var u=Object.defineProperty;var c=(t,a,e)=>a in t?u(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;var n=(t,a,e)=>(c(t,typeof a!="symbol"?a+"":a,e),e);import{af as m}from"./vue.72f2672d.js";import{S as i}from"./storage.6b2e7cd0.js";import{H as p,C as f,c as d}from"./http-client.3dda918f.js";class I extends p{constructor(){super(...arguments);n(this,"getPasswordEncryptKey",(e={})=>this.request({path:"/api/admin/auth/get-password-encrypt-key",method:"GET",secure:!0,format:"json",...e}));n(this,"getUserInfo",(e={})=>this.request({path:"/api/admin/auth/get-user-info",method:"GET",secure:!0,format:"json",...e}));n(this,"login",(e,o={})=>this.request({path:"/api/admin/auth/login",method:"POST",body:e,secure:!0,type:f.Json,format:"json",...o}));n(this,"refresh",(e,o={})=>this.request({path:"/api/admin/auth/refresh",method:"GET",query:e,secure:!0,format:"json",...o}));n(this,"getCaptcha",(e={})=>this.request({path:"/api/admin/auth/get-captcha",method:"GET",secure:!0,format:"json",...e}));n(this,"checkCaptcha",(e,o={})=>this.request({path:"/api/admin/auth/check-captcha",method:"GET",query:e,secure:!0,...o}))}}const U=m("userInfo",{state:()=>({userInfos:{userName:"",photo:"",time:0,roles:[],authBtnList:[]}}),actions:{async setUserInfos(){if(i.get("userInfo"))this.userInfos=i.get("userInfo");else{const t=await this.getApiUserInfo();this.userInfos=t}},async setUserName(t){this.userInfos.userName=t},async setPhoto(t){this.userInfos.photo=t},async getApiUserInfo(){return new Promise((t,a)=>{new I().getUserInfo().then(e=>{var o,r;if(e!=null&&e.success){const s=(o=e.data)==null?void 0:o.user,h={userName:(s==null?void 0:s.nickName)||(s==null?void 0:s.name),photo:s!=null&&s.avatar?s==null?void 0:s.avatar:"",time:new Date().getTime(),roles:[],authBtnList:(r=e.data)==null?void 0:r.permissions};t(h)}else d()}).catch(e=>{a(e)})})}}});export{I as A,U as u};
