var H=Object.defineProperty;var Y=(c,l,e)=>l in c?H(c,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):c[l]=e;var r=(c,l,e)=>(Y(c,typeof l!="symbol"?l+"":l,e),e);import{_ as L}from"./preload-helper.101896b7.js";import{c as U,e as G}from"./data-contracts.9d84138f.js";import{H as J,C as P}from"./http-client.d7f2f77a.js";import{d as W}from"./dayjs.min.0acfa903.js";import{d as D,a6 as Q,r as K,O as X,o as Z,S as u,a4 as T,e as g,f as ee,g as I,z as o,m as i,p as w,l as b,x as h,y as z,u as k,F as te,L as oe}from"./vue.df334614.js";import"./index.de963593.js";import"./index.390778f0.js";import"./index.4621962e.js";import"./storage.6b2e7cd0.js";import"./_commonjsHelpers.042e6b4d.js";class q extends J{constructor(){super(...arguments);r(this,"activate",(e,t={})=>this.request({path:"/api/bpm/work-item/activate",method:"POST",query:e,secure:!0,...t}));r(this,"suspend",(e,t={})=>this.request({path:"/api/bpm/work-item/suspend",method:"POST",query:e,secure:!0,...t}));r(this,"cancel",(e,t={})=>this.request({path:"/api/bpm/work-item/cancel",method:"POST",query:e,secure:!0,...t}));r(this,"resume",(e,t={})=>this.request({path:"/api/bpm/work-item/resume",method:"POST",query:e,secure:!0,...t}));r(this,"adustify",(e,t={})=>this.request({path:"/api/bpm/work-item/adustify",method:"POST",query:e,secure:!0,...t}));r(this,"urge",(e,t={})=>this.request({path:"/api/bpm/work-item/urge",method:"POST",query:e,secure:!0,...t}));r(this,"get",(e,t={})=>this.request({path:"/api/bpm/work-item/get",method:"GET",query:e,secure:!0,format:"json",...t}));r(this,"statstics",(e={})=>this.request({path:"/api/bpm/work-item/statstics",method:"POST",secure:!0,format:"json",...e}));r(this,"page",(e,t={})=>this.request({path:"/api/bpm/work-item/page",method:"POST",body:e,secure:!0,type:P.Json,format:"json",...t}));r(this,"start",(e,t={})=>this.request({path:"/api/bpm/work-item/start",method:"POST",query:e,secure:!0,format:"json",...t}));r(this,"getInstance",(e,t={})=>this.request({path:"/api/bpm/work-item/get-instance",method:"GET",query:e,secure:!0,format:"json",...t}));r(this,"submit",(e,t={})=>this.request({path:"/api/bpm/work-item/submit",method:"POST",body:e,secure:!0,type:P.Json,...t}));r(this,"cancelWorkItem",(e,t={})=>this.request({path:"/api/bpm/work-item/cancel-work-item",method:"POST",query:e,secure:!0,...t}))}}const ae={style:{padding:"0px 0px 8px 8px"}},ne=h(" 查询 "),se=h("进入"),ie=h("执行"),re=h("删除"),le={class:"my-flex my-flex-end",style:{"margin-top":"20px"}},pe=D({name:"bpm/template"}),ke=D({...pe,props:{state:{type:String,default:null},isMyself:{type:Boolean,default:!0},abc:{type:Boolean,default:!0}},setup(c){const l=c,e=Q(()=>L(()=>import("./myForm.8cbaaf13.js"),["assets/myForm.8cbaaf13.js","assets/preload-helper.101896b7.js","assets/data-contracts.9d84138f.js","assets/http-client.d7f2f77a.js","assets/index.de963593.js","assets/index.390778f0.js","assets/vue.df334614.js","assets/index.4621962e.js","assets/storage.6b2e7cd0.js","assets/_plugin-vue_export-helper.c27b6911.js","assets/myForm.8bf82b27.css"])),t=K(),{proxy:O}=oe(),a=X({loading:!1,filterModel:{name:""},total:0,pageInput:{currentPage:1,pageSize:20,Filter:{State:l.state,isMyself:l.isMyself,Name:""}},listData:[]});Z(()=>{_()});const v=n=>{t.value.open({type:1,workItemId:n.id,templateId:n.workflowTemplateId})},M=(n,p,d)=>W(d).format("YYYY-MM-DD HH:mm:ss"),_=async()=>{var p,d;a.loading=!0;const n=await new q().page(a.pageInput);a.listData=((p=n==null?void 0:n.data)==null?void 0:p.list)??[],a.total=((d=n.data)==null?void 0:d.total)??0,a.loading=!1},N=n=>{O.$modal.confirmDelete(`确定要删除【${n.name}】工作项?`).then(async()=>{await new q().delete({id:n.id},{loading:!0,showSuccessMessage:!0}),_()}).catch(()=>{})},j=n=>{a.pageInput.pageSize=n,_()},B=n=>{a.pageInput.currentPage=n,_()};return(n,p)=>{const d=u("el-input"),S=u("el-form-item"),f=u("el-button"),V=u("el-form"),x=u("el-card"),m=u("el-table-column"),$=u("el-link"),E=u("el-tag"),R=u("el-table"),A=u("el-pagination"),C=T("auth"),F=T("loading");return g(),ee(te,null,[I("div",ae,[o(x,{shadow:"never","body-style":{paddingBottom:"0"},style:{"margin-top":"8px"}},{default:i(()=>[o(V,{model:a.filterModel,inline:!0},{default:i(()=>[o(S,{prop:"name"},{default:i(()=>[o(d,{modelValue:a.filterModel.name,"onUpdate:modelValue":p[0]||(p[0]=s=>a.filterModel.name=s),placeholder:"工作项名称"},null,8,["modelValue"])]),_:1}),o(S,null,{default:i(()=>[o(f,{type:"primary",icon:"ele-Search",onClick:_},{default:i(()=>[ne]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),o(x,{shadow:"never",style:{"margin-top":"8px"}},{default:i(()=>[w((g(),b(R,{data:a.listData,"row-key":"id",style:{width:"100%"},border:""},{default:i(()=>[o(m,{type:"index",width:"60",label:"序号"}),o(m,{prop:"activityName",label:"工作项名称","min-width":"120","show-overflow-tooltip":""},{default:i(({row:s})=>[o($,{onClick:y=>v(s)},{default:i(()=>[h(z(s.activityName),1)]),_:2},1032,["onClick"])]),_:1}),o(m,{prop:"referenceNo",label:"单号","show-overflow-tooltip":"",width:"120"}),o(m,{prop:"instanceName",label:"流程名称","show-overflow-tooltip":"",width:"120"}),o(m,{prop:"state",label:"工作项状态",width:"100"},{default:i(({row:s})=>[o(E,{"disable-transitions":"",type:k(U)[s.state&127].toLowerCase()},{default:i(()=>[h(z(k(G)[s.state]),1)]),_:2},1032,["type"])]),_:1}),o(m,{prop:"initiator",label:"创建人","show-overflow-tooltip":"",width:"120"}),o(m,{prop:"participant",label:"审核人","show-overflow-tooltip":"",width:"120"}),o(m,{prop:"executor",label:"处理人","show-overflow-tooltip":"",width:"120"}),o(m,{prop:"startTime",label:"创建时间",formatter:M,width:"180"}),o(m,{label:"操作",width:"180",fixed:"right","header-align":"center",align:"center"},{default:i(({row:s})=>[o(f,{icon:"ele-CaretRight",size:"small",text:"",type:"primary",onClick:y=>v(s)},{default:i(()=>[se]),_:2},1032,["onClick"]),w((g(),b(f,{icon:"ele-Promotion",size:"small",text:"",type:"primary",onClick:y=>n.onRun(s)},{default:i(()=>[ie]),_:2},1032,["onClick"])),[[C,"api:bpm:template:run"]]),w((g(),b(f,{icon:"ele-Delete",size:"small",text:"",type:"danger",onClick:y=>N(s)},{default:i(()=>[re]),_:2},1032,["onClick"])),[[C,"api:bpm:template:delete"]])]),_:1})]),_:1},8,["data"])),[[F,a.loading]]),I("div",le,[o(A,{currentPage:a.pageInput.currentPage,"onUpdate:currentPage":p[1]||(p[1]=s=>a.pageInput.currentPage=s),"page-size":a.pageInput.pageSize,"onUpdate:page-size":p[2]||(p[2]=s=>a.pageInput.pageSize=s),total:a.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:j,onCurrentChange:B,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])]),_:1})]),o(k(e),{ref_key:"formRef",ref:t},null,512)],64)}}});export{ke as default};
