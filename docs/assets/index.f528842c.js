import T from"./Permission.7427cd78.js";import P from"./Operation.87dde98a.js";import S from"./Participant.0e8904be.js";import O from"./Condition.c612eac6.js";import z from"./Circulate.cc347be4.js";import{C as j}from"./index.55c7ed79.js";import{S as t,e as u,l as d,C as J,m as o,x as p,y as C,p as E,v as B,g as N,z as i,t as r,f as h}from"./vue.72f2672d.js";import{_ as U}from"./_plugin-vue_export-helper.c27b6911.js";import"./index.972b8136.js";import"./user-select.3de4c006.js";import"./User.7b8f477f.js";import"./http-client.193f2c5b.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";import"./org-menu.vue_vue_type_script_setup_true_lang.44f66112.js";import"./Org.a1ce8cb9.js";import"./tree.d5b28a07.js";import"./index.79e12c01.js";import"./index.1e09e151.js";import"./index.eead254e.js";import"./_Uint8Array.e4cf923d.js";import"./_initCloneObject.7b8933bc.js";import"./focus-trap.c8a23a9c.js";import"./org-select.vue_vue_type_script_setup_true_lang.940de93a.js";import"./role-select.vue_vue_type_script_setup_true_lang.2c88811a.js";import"./Role.ffc550a0.js";const M={inject:["titleChange"],directives:{ClickOutside:j},components:{Permission:T,Participant:S,Condition:O,Circulate:z,Operation:P},props:{fields:{type:Array,default:()=>{}},conditions:{type:Array,default:()=>{}},node:{type:Object,default:()=>{}}},data(){return{titleInputVisible:!1,curNode:{},isDrawer:!1,workflowTypes:[{label:"开始",value:"start"},{label:"结束",value:"end"},{label:"条件",value:"condition"},{label:"传阅",value:"circulate"},{label:"审批",value:"approver"}]}},watch:{isDrawer(s){s?this.$nextTick(()=>{this.curNode=JSON.parse(JSON.stringify(this.node))}):this.curNode={}}},methods:{showTitleInput(){this.titleInputVisible=!0,this.$nextTick(()=>this.$refs.titleInput.focus())},onTitleChange(){this.titleChange(this.curNode.title),this.titleInputVisible=!1},onConfirm(){var s,l,n,m;this.node.approve=(s=this.$refs.approvePanel)==null?void 0:s.onConfirm(),this.node.permission=(l=this.$refs.permissionPanel)==null?void 0:l.onConfirm(),this.node.condition=(n=this.$refs.conditionPanel)==null?void 0:n.onConfirm(),this.node.circulate=(m=this.$refs.circulatePanel)==null?void 0:m.onConfirm(),console.log("  panel confirmed"),this.close()},close(){this.isDrawer=!1},open(){this.isDrawer=!0,this.$nextTick(()=>{})}}},q={key:0},G={key:1},H={key:2},K={style:{flex:"auto"}},L=p("取消"),Q=p("确定");function R(s,l,n,m,e,c){const b=t("ele-Edit"),k=t("el-icon"),F=t("el-input"),v=t("condition"),a=t("el-tab-pane"),A=t("participant"),w=t("permission"),D=t("circulate");t("el-option"),t("el-select");const V=t("el-tabs"),y=t("el-button"),x=t("el-drawer");return n.node?(u(),d(x,{key:0,title:"$t('message.layout.configTitle')",modelValue:e.isDrawer,"onUpdate:modelValue":l[3]||(l[3]=f=>e.isDrawer=f),direction:"rtl",isModal:"false","destroy-on-close":"",size:"600px"},J({footer:o(()=>[N("div",K,[i(y,{onClick:c.close},{default:o(()=>[L]),_:1},8,["onClick"]),i(y,{type:"primary",onClick:c.onConfirm},{default:o(()=>[Q]),_:1},8,["onClick"])])]),default:o(()=>[i(V,{type:"border-card",style:{height:"calc(100vh - 95px)"}},{default:o(()=>[e.curNode.type==="condition"?(u(),d(a,{key:0,label:"条件"},{default:o(()=>[i(v,{ref:"conditionPanel",fields:n.fields,conditions:n.conditions,data:e.curNode.condition},null,8,["fields","conditions","data"])]),_:1})):r("",!0),["approve","deal"].includes(e.curNode.type)?(u(),d(a,{key:1,label:"参与人设置"},{default:o(()=>[i(A,{ref:"approvePanel",fields:n.fields,data:e.curNode.approve},null,8,["fields","data"])]),_:1})):r("",!0),["approve","start","deal"].includes(e.curNode.type)?(u(),d(a,{key:2,label:"表单权限"},{default:o(()=>[i(w,{ref:"permissionPanel",fields:n.fields,data:e.curNode.permission},null,8,["fields","data"])]),_:1})):r("",!0),e.curNode.type==="circulate"?(u(),d(a,{key:3,label:"传阅"},{default:o(()=>[i(D,{ref:"circulatePanel",fields:n.fields,data:e.curNode.circulate},null,8,["fields","data"])]),_:1})):r("",!0),i(a,{label:"说明"},{default:o(()=>[e.curNode.type==="start"?(u(),h("div",q," 每个流程只允许一个启动节点 ")):e.curNode.type==="end"?(u(),h("div",G," 每个流程只允许一个结束节点； 结束节点可以有一条或者多条入向连接，但没有出向连接。 ")):(u(),h("div",H," 这里是节点说明 "))]),_:1}),r("",!0)]),_:1})]),_:2},[e.curNode&&e.curNode.type=="start"?{name:"header",fn:o(({close:f,titleId:I,titleClass:g})=>[p(C(e.curNode.title),1)]),key:"0"}:{name:"header",fn:o(({close:f,titleId:I,titleClass:g})=>[E(N("span",{onClick:l[0]||(l[0]=(..._)=>c.showTitleInput&&c.showTitleInput(..._)),style:{cursor:"pointer"}},[p(C(e.curNode.title)+" ",1),i(k,{style:{"font-size":"1.5em"}},{default:o(()=>[i(b)]),_:1})],512),[[B,!e.titleInputVisible]]),E(i(F,{ref:"titleInput",size:"mini",modelValue:e.curNode.title,"onUpdate:modelValue":l[1]||(l[1]=_=>e.curNode.title=_),placeholder:"请输入节点标签",onBlur:c.onTitleChange},null,8,["modelValue","onBlur"]),[[B,e.titleInputVisible]])]),key:"1"}]),1032,["title","modelValue"])):r("",!0)}const ke=U(M,[["render",R]]);export{ke as default};
