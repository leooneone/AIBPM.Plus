import{O as v}from"./Org.791a1909.js";import{l as C}from"./tree.d5b28a07.js";import{b as D}from"./index.6c5a2d2c.js";import{d as f,r as w,O as V,w as K,o as N,H as b,S as d,a4 as B,e as i,l as O,m as c,z as u,p as F,f as M,D as E,u as R}from"./vue.df334614.js";const z=f({name:"admin/org/menu"}),S=f({...z,props:{modelValue:{default:()=>[]},checkedKeys:{default:()=>[]},selectFirstNode:{type:Boolean,default:!1}},emits:["node-click","update:modelValue"],setup(p,{expose:m,emit:r}){const s=p,o=w(),t=V({loading:!1,filterText:"",orgTreeData:[],lastKey:0});K(()=>t.filterText,e=>{var a;(a=o.value)==null||a.filter(e)}),N(()=>{_()});const g=(e,a)=>{var l;return e?((l=a.name)==null?void 0:l.indexOf(e))!==-1:!0},h=e=>{var a;t.lastKey===e.id?(t.lastKey=0,(a=o.value)==null||a.setCurrentKey(void 0),r("node-click",null)):(t.lastKey=e.id,r("node-click",e))},k=()=>{var e;r("update:modelValue",(e=o.value)==null?void 0:e.getCheckedNodes())},_=async()=>{t.loading=!0;const e=await new v().getList();t.loading=!1,e!=null&&e.success&&e.data&&e.data.length>0?(t.orgTreeData=C(e.data),s.selectFirstNode&&b(()=>{var l;const a=t.orgTreeData[0];(l=o.value)==null||l.setCurrentKey(a.id),r("node-click",a)})):t.orgTreeData=[]};return m({orgMenuRef:o}),(e,a)=>{const l=d("el-input"),y=d("el-card"),x=B("loading");return i(),O(y,{shadow:"never",style:{"margin-top":"8px"}},{header:c(()=>[u(l,{modelValue:t.filterText,"onUpdate:modelValue":a[0]||(a[0]=n=>t.filterText=n),placeholder:"筛选部门",clearable:""},null,8,["modelValue"])]),default:c(()=>{var n;return[F((i(),M("div",null,[u(R(D),E({ref_key:"orgMenuRef",ref:o,data:t.orgTreeData,"node-key":"id",props:{children:"children",label:"name"},"filter-node-method":g,"highlight-current":"","check-strictly":"","default-expand-all":"","render-after-expand":"","expand-on-click-node":!1},e.$attrs,{"default-checked-keys":(n=s.modelValue)==null?void 0:n.map(T=>T.id),"show-checkbox":"",onNodeClick:h,onCheckChange:k}),null,16,["data","default-checked-keys"])])),[[x,t.loading]])]}),_:1})}}});export{S as _};
