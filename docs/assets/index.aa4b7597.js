import{_ as h}from"./preload-helper.101896b7.js";import{d as E,a6 as w,r as M,O as q,o as H,P as J,S as l,a4 as y,e as s,f as X,z as n,m as o,G as Y,E as Z,p as u,l as d,u as m,t as z,g as ee,x as _,L as te}from"./vue.df334614.js";import{T as I}from"./Tenant.653cddf4.js";import{e as D}from"./mitt.7f99bbc0.js";import{a as S}from"./authFunction.e2ce872b.js";import"./http-client.28a8ff7a.js";import"./index.de963593.js";import"./index.390778f0.js";import"./index.4621962e.js";import"./storage.6b2e7cd0.js";import"./userInfo.fd51b0f3.js";import"./arrayOperation.b573dead.js";const ne={style:{padding:"0px 0px 8px 8px"}},oe=_(" 查询 "),ae=_(" 新增 "),le=_("编辑"),ie=_("菜单权限"),re=_("删除租户"),se={class:"my-flex my-flex-end",style:{"margin-top":"20px"}},pe=E({name:"admin/tenant"}),Ce=E({...pe,setup(de){const V=w(()=>h(()=>import("./tenant-form.dea48312.js"),["assets/tenant-form.dea48312.js","assets/Tenant.653cddf4.js","assets/http-client.28a8ff7a.js","assets/index.de963593.js","assets/index.390778f0.js","assets/vue.df334614.js","assets/index.4621962e.js","assets/storage.6b2e7cd0.js","assets/test.dc379863.js","assets/toolsValidate.7cb139e2.js","assets/mitt.7f99bbc0.js"])),F=w(()=>h(()=>import("./index.6c24773e.js"),["assets/index.6c24773e.js","assets/vue.df334614.js","assets/_plugin-vue_export-helper.c27b6911.js"])),L=w(()=>h(()=>import("./set-tenant-menu.d074aa86.js"),["assets/set-tenant-menu.d074aa86.js","assets/Permission.54b076e4.js","assets/http-client.28a8ff7a.js","assets/index.de963593.js","assets/index.390778f0.js","assets/vue.df334614.js","assets/index.4621962e.js","assets/storage.6b2e7cd0.js","assets/tree.d5b28a07.js","assets/index.6c5a2d2c.js","assets/index.7cba2d6b.js","assets/index.f4a20413.js","assets/_Uint8Array.2a02cf9e.js","assets/cloneDeep.4b31f8c5.js","assets/_initCloneObject.115dee92.js","assets/_plugin-vue_export-helper.c27b6911.js","assets/set-tenant-menu.6d4965c3.css"])),{proxy:v}=te(),f=M(),x=M(),e=q({loading:!1,tenantFormTitle:"",filterModel:{name:""},total:0,pageInput:{currentPage:1,pageSize:20},tenantListData:[]});H(()=>{r(),D.on("refreshTenant",async()=>{r()})}),J(()=>{D.off("refreshTenant")});const r=async()=>{var a,c;e.loading=!0;const t=await new I().getPage(e.pageInput);e.tenantListData=((a=t==null?void 0:t.data)==null?void 0:a.list)??[],e.total=((c=t.data)==null?void 0:c.total)??0,e.loading=!1},R=()=>{e.tenantFormTitle="新增租户",f.value.open()},A=t=>{e.tenantFormTitle="编辑租户",f.value.open(t)},$=t=>{v.$modal.confirmDelete(`确定要删除【${t.name}】?`).then(async()=>{await new I().delete({id:t.id},{loading:!0,showSuccessMessage:!0}),r()}).catch(()=>{})},B=t=>{e.pageInput.pageSize=t,r()},N=t=>{e.pageInput.currentPage=t,r()},O=t=>{if(!((t==null?void 0:t.id)>0)){v.$modal.msgWarning("请选择租户");return}x.value.open(t)};return(t,a)=>{const c=l("el-input"),k=l("el-form-item"),g=l("el-button"),U=l("el-form"),C=l("el-card"),p=l("el-table-column"),T=l("el-dropdown-item"),K=l("el-dropdown-menu"),j=l("el-table"),G=l("el-pagination"),b=y("auth"),Q=y("auths"),W=y("loading");return s(),X("div",ne,[n(C,{shadow:"never","body-style":{paddingBottom:"0"},style:{"margin-top":"8px"}},{default:o(()=>[n(U,{model:e.filterModel,inline:!0,onSubmit:a[1]||(a[1]=Y(()=>{},["stop","prevent"]))},{default:o(()=>[n(k,{label:"姓名",prop:"name"},{default:o(()=>[n(c,{modelValue:e.filterModel.name,"onUpdate:modelValue":a[0]||(a[0]=i=>e.filterModel.name=i),placeholder:"姓名",onKeyup:Z(r,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),n(k,null,{default:o(()=>[n(g,{type:"primary",icon:"ele-Search",onClick:r},{default:o(()=>[oe]),_:1}),u((s(),d(g,{type:"primary",icon:"ele-Plus",onClick:R},{default:o(()=>[ae]),_:1})),[[b,"api:admin:tenant:add"]])]),_:1})]),_:1},8,["model"])]),_:1}),n(C,{shadow:"never",style:{"margin-top":"8px"}},{default:o(()=>[u((s(),d(j,{data:e.tenantListData,"row-key":"id",style:{width:"100%"}},{default:o(()=>[n(p,{prop:"name",label:"企业名称","min-width":"120","show-overflow-tooltip":""}),n(p,{prop:"code",label:"企业编码",width:"120","show-overflow-tooltip":""}),n(p,{prop:"realName",label:"姓名",width:"120","show-overflow-tooltip":""}),n(p,{prop:"phone",label:"手机号",width:"120","show-overflow-tooltip":""}),n(p,{prop:"email",label:"邮箱","min-width":"120","show-overflow-tooltip":""}),n(p,{label:"操作",width:"160",fixed:"right","header-align":"center",align:"center"},{default:o(({row:i})=>[u((s(),d(g,{icon:"ele-EditPen",size:"small",text:"",type:"primary",onClick:P=>A(i)},{default:o(()=>[le]),_:2},1032,["onClick"])),[[b,"api:admin:tenant:update"]]),u((s(),d(m(F),null,{dropdown:o(()=>[n(K,null,{default:o(()=>[m(S)("api:admin:permission:assign")?(s(),d(T,{key:0,onClick:P=>O(i)},{default:o(()=>[ie]),_:2},1032,["onClick"])):z("",!0),m(S)("api:admin:tenant:delete")?(s(),d(T,{key:1,onClick:P=>$(i)},{default:o(()=>[re]),_:2},1032,["onClick"])):z("",!0)]),_:2},1024)]),_:2},1024)),[[Q,["api:admin:permission:assign","api:admin:tenant:delete"]]])]),_:1})]),_:1},8,["data"])),[[W,e.loading]]),ee("div",se,[n(G,{currentPage:e.pageInput.currentPage,"onUpdate:currentPage":a[2]||(a[2]=i=>e.pageInput.currentPage=i),"page-size":e.pageInput.pageSize,"onUpdate:page-size":a[3]||(a[3]=i=>e.pageInput.pageSize=i),total:e.total,"page-sizes":[10,20,50,100],small:"",background:"",onSizeChange:B,onCurrentChange:N,layout:"total, sizes, prev, pager, next, jumper"},null,8,["currentPage","page-size","total"])])]),_:1}),n(m(V),{ref_key:"tenantFormRef",ref:f,title:e.tenantFormTitle},null,8,["title"]),n(m(L),{ref_key:"setTenantMenuRef",ref:x},null,512)])}}});export{Ce as default};
