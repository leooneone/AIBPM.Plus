import{P as i}from"./Permission.f7fb243a.js";import{l as b}from"./tree.d5b28a07.js";import{b as P}from"./index.79e12c01.js";import{c as V}from"./cloneDeep.d5c086cd.js";import{d as f,c as I,O as K,r as N,S as p,e as S,l as z,m as n,g as m,z as r,u,x as g,L as B}from"./vue.72f2672d.js";import{_ as M}from"./_plugin-vue_export-helper.c27b6911.js";import"./http-client.193f2c5b.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";import"./index.1e09e151.js";import"./index.eead254e.js";import"./_Uint8Array.e4cf923d.js";import"./_initCloneObject.7b8933bc.js";const $={class:"dialog-footer"},R=g("取 消"),A=g("确 定"),E=f({name:"admin/tenant/components/set-tenant-menu"}),O=f({...E,props:{title:{type:String,default:""}},setup(_,{expose:h}){const l=_,y=I(()=>l.title?l.title:e.name?`设置【${e.name}】菜单权限`:"设置菜单权限"),e=K({showDialog:!1,loading:!1,sureLoading:!1,permissionTreeData:[],id:0,name:"",checkedKeys:[]}),{proxy:c}=B(),d=N(),w=async()=>{const t=await new i().getTenantPermissionList({tenantId:e.id});e.checkedKeys=t!=null&&t.success?t.data:[]},k=async t=>{e.id=t.id,e.name=t.name,c.$modal.loading(),await x(),await w(),c.$modal.closeLoading(),e.showDialog=!0},T=()=>{e.showDialog=!1},x=async()=>{e.loading=!0;const t=await new i().getPermissionList();t.data&&t.data.length>0?e.permissionTreeData=b(V(t.data)):e.permissionTreeData=[],e.loading=!1},D=t=>t.row?"is-penultimate":"",L=()=>{e.showDialog=!1},C=async()=>{var a;e.sureLoading=!0;const t=(a=d.value)==null?void 0:a.getCheckedKeys(!0),s={tenantId:e.id,permissionIds:t},o=await new i().saveTenantPermissions(s,{showSuccessMessage:!0}).catch(()=>{e.sureLoading=!1});e.sureLoading=!1,o!=null&&o.success&&(e.showDialog=!1)};return h({open:k,close:T}),(t,s)=>{const o=p("el-button"),a=p("el-dialog");return S(),z(a,{modelValue:e.showDialog,"onUpdate:modelValue":s[0]||(s[0]=v=>e.showDialog=v),"destroy-on-close":"",title:u(y),"append-to-body":"",draggable:"",width:"780px"},{footer:n(()=>[m("span",$,[r(o,{onClick:L,size:"default"},{default:n(()=>[R]),_:1}),r(o,{type:"primary",onClick:C,size:"default",loading:e.sureLoading},{default:n(()=>[A]),_:1},8,["loading"])])]),default:n(()=>[m("div",null,[r(u(P),{ref_key:"permissionTreeRef",ref:d,data:e.permissionTreeData,"node-key":"id","show-checkbox":"","highlight-current":"","default-expand-all":"","check-on-click-node":"","expand-on-click-node":!1,props:{class:D},"default-checked-keys":e.checkedKeys},null,8,["data","props","default-checked-keys"])])]),_:1},8,["modelValue","title"])}}});const se=M(O,[["__scopeId","data-v-075685fa"]]);export{se as default};
