import{V as p}from"./View.fdf4950c.js";import{e as C}from"./mitt.7f99bbc0.js";import{d as b,r as S,O as z,K as L,S as s,e as B,f as N,z as l,m as t,g as R,u as n,x as w}from"./vue.72f2672d.js";import"./http-client.3dda918f.js";import"./index.57385bce.js";import"./index.0c380c40.js";import"./index.41e0794f.js";import"./storage.6b2e7cd0.js";const T={class:"dialog-footer"},A=w("取 消"),M=w("确 定"),q=b({name:"admin/view/form"}),P=b({...q,props:{title:{type:String,default:""},viewTreeData:{type:Array,default:()=>[]}},setup(c,{expose:x}){const _=S(),a=z({showDialog:!1,sureLoading:!1,form:{enabled:!0,cache:!0}}),{form:o}=L(a),y=async(i={})=>{if(i.id>0){const e=await new p().get({id:i.id},{loading:!0});if(e!=null&&e.success){let m=e.data;m.parentId=m.parentId&&m.parentId>0?m.parentId:void 0,a.form=m}}else a.form={enabled:!0,cache:!0};a.showDialog=!0},h=()=>{a.showDialog=!1},v=()=>{_.value.validate(async i=>{if(!i)return;a.sureLoading=!0;let e={};a.form.parentId=a.form.parentId&&a.form.parentId>0?a.form.parentId:void 0,a.form.id!=null&&a.form.id>0?e=await new p().update(a.form,{showSuccessMessage:!0}):e=await new p().add(a.form,{showSuccessMessage:!0}),a.sureLoading=!1,e!=null&&e.success&&(C.emit("refreshView"),a.showDialog=!1)})};return x({open:y}),(i,e)=>{const m=s("el-tree-select"),r=s("el-form-item"),u=s("el-col"),f=s("el-input"),I=s("el-input-number"),g=s("el-switch"),D=s("el-row"),U=s("el-form"),V=s("el-button"),k=s("el-dialog");return B(),N("div",null,[l(k,{modelValue:a.showDialog,"onUpdate:modelValue":e[8]||(e[8]=d=>a.showDialog=d),"destroy-on-close":"",title:c.title,draggable:"",width:"600px"},{footer:t(()=>[R("span",T,[l(V,{onClick:h,size:"default"},{default:t(()=>[A]),_:1}),l(V,{type:"primary",onClick:v,size:"default",loading:a.sureLoading},{default:t(()=>[M]),_:1},8,["loading"])])]),default:t(()=>[l(U,{model:n(o),ref_key:"formRef",ref:_,size:"default","label-width":"80px"},{default:t(()=>[l(D,{gutter:35},{default:t(()=>[l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(r,{label:"上级视图"},{default:t(()=>[l(m,{modelValue:n(o).parentId,"onUpdate:modelValue":e[0]||(e[0]=d=>n(o).parentId=d),data:c.viewTreeData,"node-key":"id","check-strictly":"","default-expand-all":"","render-after-expand":"","fit-input-width":"",clearable:"",class:"w100"},null,8,["modelValue","data"])]),_:1})]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(r,{label:"视图名称",prop:"label",rules:[{required:!0,message:"请输入视图名称",trigger:["blur","change"]}]},{default:t(()=>[l(f,{modelValue:n(o).label,"onUpdate:modelValue":e[1]||(e[1]=d=>n(o).label=d),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(r,{label:"视图命名",prop:"path"},{default:t(()=>[l(f,{modelValue:n(o).name,"onUpdate:modelValue":e[2]||(e[2]=d=>n(o).name=d),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(r,{label:"视图地址",prop:"path"},{default:t(()=>[l(f,{modelValue:n(o).path,"onUpdate:modelValue":e[3]||(e[3]=d=>n(o).path=d),clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:10,md:10,lg:10,xl:10},{default:t(()=>[l(r,{label:"排序"},{default:t(()=>[l(I,{modelValue:n(o).sort,"onUpdate:modelValue":e[4]||(e[4]=d=>n(o).sort=d)},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:7,md:7,lg:7,xl:7},{default:t(()=>[l(r,{label:"缓存"},{default:t(()=>[l(g,{modelValue:n(o).cache,"onUpdate:modelValue":e[5]||(e[5]=d=>n(o).cache=d)},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:7,md:7,lg:7,xl:7},{default:t(()=>[l(r,{label:"启用"},{default:t(()=>[l(g,{modelValue:n(o).enabled,"onUpdate:modelValue":e[6]||(e[6]=d=>n(o).enabled=d)},null,8,["modelValue"])]),_:1})]),_:1}),l(u,{xs:24,sm:24,md:24,lg:24,xl:24},{default:t(()=>[l(r,{label:"视图描述",prop:"description"},{default:t(()=>[l(f,{modelValue:n(o).description,"onUpdate:modelValue":e[7]||(e[7]=d=>n(o).description=d),clearable:"",type:"textarea"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});export{P as default};
